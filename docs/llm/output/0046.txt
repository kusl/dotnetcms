kushal@fedora:~/src/dotnet/MyBlog$ cd ~/src/dotnet/MyBlog/ && export DOTNET_CLI_TELEMETRY_OPTOUT=1 && (cd src && time dotnet format; time dotnet restore; time dotnet clean; time dotnet build; time dotnet run --project MyBlog.Tests/MyBlog.Tests.csproj; time dotnet list package; time dotnet list package --outdated); cd ~/src/dotnet/MyBlog/ && time bash export.sh; cat run-e2e.sh; time bash run-e2e.sh --clean; time bash run-e2e.sh;

real	0m8.922s
user	0m14.127s
sys	0m1.055s
Restore complete (0.5s)

Build succeeded in 0.6s

real	0m0.723s
user	0m0.803s
sys	0m0.182s

Build succeeded in 0.5s

real	0m0.692s
user	0m0.762s
sys	0m0.182s
Restore complete (0.5s)
  MyBlog.Core net10.0 succeeded (3.0s) → MyBlog.Core/bin/Debug/net10.0/MyBlog.Core.dll
  MyBlog.Infrastructure net10.0 succeeded (0.5s) → MyBlog.Infrastructure/bin/Debug/net10.0/MyBlog.Infrastructure.dll
  MyBlog.Web net10.0 succeeded (2.6s) → MyBlog.Web/bin/Debug/net10.0/MyBlog.Web.dll
  MyBlog.Tests net10.0 succeeded (0.6s) → MyBlog.Tests/bin/Debug/net10.0/MyBlog.Tests.dll
  MyBlog.E2E net10.0 succeeded (0.6s) → MyBlog.E2E/bin/Debug/net10.0/MyBlog.E2E.dll

Build succeeded in 7.3s

real	0m7.514s
user	0m2.633s
sys	0m0.469s
xUnit.net v3 In-Process Runner v3.2.2+728c1dce01 (64-bit .NET 10.0.2)
  Discovering: MyBlog.Tests
  Discovered:  MyBlog.Tests
  Starting:    MyBlog.Tests
  Finished:    MyBlog.Tests (ID = '24cedafe73dab5684218bb3cf04cfd49ae8ce3b87ae799399cb2e301cbc1e755')
=== TEST EXECUTION SUMMARY ===
   MyBlog.Tests  Total: 77, Errors: 0, Failed: 0, Skipped: 0, Not Run: 0, Time: 41.439s

real	0m43.375s
user	0m46.055s
sys	0m0.656s
Restore complete (0.4s)

Build succeeded in 0.5s
Project 'MyBlog.Core' has the following package references
   [net10.0]: 
   Top-level Package                   Requested   Resolved
   > Microsoft.Extensions.Logging      10.0.2      10.0.2  

Project 'MyBlog.E2E' has the following package references
   [net10.0]: 
   Top-level Package             Requested   Resolved
   > Microsoft.NET.Test.Sdk      18.0.1      18.0.1  
   > Microsoft.Playwright        1.57.0      1.57.0  
   > xunit.v3                    3.2.2       3.2.2   

Project 'MyBlog.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                           Requested   Resolved
   > Microsoft.AspNetCore.Identity             2.3.9       2.3.9   
   > Microsoft.EntityFrameworkCore.Sqlite      10.0.2      10.0.2  
   > Microsoft.Extensions.Http                 10.0.2      10.0.2  
   > OpenTelemetry                             1.15.0      1.15.0  

Project 'MyBlog.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > Microsoft.EntityFrameworkCore.Sqlite        10.0.2      10.0.2  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > Microsoft.Testing.Extensions.TrxReport      2.0.2       2.0.2   
   > xunit.v3                                    3.2.2       3.2.2   

Project 'MyBlog.Web' has the following package references
   [net10.0]: 
   Top-level Package                                  Requested    Resolved
   > Microsoft.AspNetCore.App.Internal.Assets   (A)   [10.0.2, )   10.0.2  
   > Microsoft.AspNetCore.SignalR.Client              10.0.2       10.0.2  
   > OpenTelemetry.Exporter.Console                   1.15.0       1.15.0  
   > OpenTelemetry.Extensions.Hosting                 1.15.0       1.15.0  
   > OpenTelemetry.Instrumentation.AspNetCore         1.15.0       1.15.0  
   > OpenTelemetry.Instrumentation.Http               1.15.0       1.15.0  

(A) : Auto-referenced package.

real	0m1.591s
user	0m1.645s
sys	0m0.349s
Restore complete (0.5s)

Build succeeded in 0.6s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyBlog.Core` has no updates given the current sources.
The given project `MyBlog.E2E` has no updates given the current sources.
The given project `MyBlog.Infrastructure` has no updates given the current sources.
The given project `MyBlog.Tests` has no updates given the current sources.
The given project `MyBlog.Web` has no updates given the current sources.

real	0m3.199s
user	0m1.988s
sys	0m0.424s
==============================================
  Project Export for LLM Analysis
==============================================

Project Path: /home/kushal/src/dotnet/MyBlog
Output File:  docs/llm/dump.txt

Generating directory structure...
Collecting files...
Found 115 files to export

Processing (1/115): docker-compose.e2e.yml
Processing (2/115): docker-compose.yml
Processing (3/115): .editorconfig
Processing (4/115): export.sh
Processing (5/115): .github/workflows/build-deploy.yml
Processing (6/115): .gitignore
Processing (7/115): README.md
Processing (8/115): run-e2e.sh
Processing (9/115): src/Directory.Build.props
Processing (10/115): src/Directory.Packages.props
Processing (11/115): src/.github/workflows/build-deploy.yml
Processing (12/115): src/global.json
Processing (13/115): src/MyBlog.Core/Constants/AppConstants.cs
Processing (14/115): src/MyBlog.Core/Interfaces/IAuthService.cs
Processing (15/115): src/MyBlog.Core/Interfaces/IImageDimensionService.cs
Processing (16/115): src/MyBlog.Core/Interfaces/IImageRepository.cs
Processing (17/115): src/MyBlog.Core/Interfaces/IMarkdownService.cs
Processing (18/115): src/MyBlog.Core/Interfaces/IPasswordService.cs
Processing (19/115): src/MyBlog.Core/Interfaces/IPostRepository.cs
Processing (20/115): src/MyBlog.Core/Interfaces/IReaderTrackingService.cs
Processing (21/115): src/MyBlog.Core/Interfaces/ISlugService.cs
Processing (22/115): src/MyBlog.Core/Interfaces/ITelemetryLogRepository.cs
Processing (23/115): src/MyBlog.Core/Interfaces/IUserRepository.cs
Processing (24/115): src/MyBlog.Core/Models/Image.cs
Processing (25/115): src/MyBlog.Core/Models/ImageDimensionCache.cs
Processing (26/115): src/MyBlog.Core/Models/Post.cs
Processing (27/115): src/MyBlog.Core/Models/PostDto.cs
Processing (28/115): src/MyBlog.Core/Models/TelemetryLog.cs
Processing (29/115): src/MyBlog.Core/Models/User.cs
Processing (30/115): src/MyBlog.Core/MyBlog.Core.csproj
Processing (31/115): src/MyBlog.Core/Services/MarkdownService.cs
Processing (32/115): src/MyBlog.Core/Services/SlugService.cs
Processing (33/115): src/MyBlog.E2E/Dockerfile
Processing (34/115): src/MyBlog.E2E/MyBlog.E2E.csproj
Processing (35/115): src/MyBlog.E2E/PlaywrightCollection.cs
Processing (36/115): src/MyBlog.E2E/PlaywrightFixture.cs
Processing (37/115): src/MyBlog.E2E/Tests/AboutPageTests.cs
Processing (38/115): src/MyBlog.E2E/Tests/HomePageTests.cs
Processing (39/115): src/MyBlog.E2E/Tests/LoginPageTests.cs
Processing (40/115): src/MyBlog.E2E/Tests/ThemeSwitcherTests.cs
Processing (41/115): src/MyBlog.Infrastructure/Data/BlogDbContext.cs
Processing (42/115): src/MyBlog.Infrastructure/Data/DatabasePathResolver.cs
Processing (43/115): src/MyBlog.Infrastructure/Data/DatabaseSchemaUpdater.cs
Processing (44/115): src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj
Processing (45/115): src/MyBlog.Infrastructure/Repositories/ImageRepository.cs
Processing (46/115): src/MyBlog.Infrastructure/Repositories/PostRepository.cs
Processing (47/115): src/MyBlog.Infrastructure/Repositories/TelemetryLogRepository.cs
Processing (48/115): src/MyBlog.Infrastructure/Repositories/UserRepository.cs
Processing (49/115): src/MyBlog.Infrastructure/ServiceCollectionExtensions.cs
Processing (50/115): src/MyBlog.Infrastructure/Services/AuthService.cs
Processing (51/115): src/MyBlog.Infrastructure/Services/ImageCacheWarmerService.cs
Processing (52/115): src/MyBlog.Infrastructure/Services/ImageDimensionService.cs
Processing (53/115): src/MyBlog.Infrastructure/Services/PasswordService.cs
Processing (54/115): src/MyBlog.Infrastructure/Services/ReaderTrackingService.cs
Processing (55/115): src/MyBlog.Infrastructure/Services/TelemetryCleanupService.cs
Processing (56/115): src/MyBlog.Infrastructure/Telemetry/DatabaseLogExporter.cs
Processing (57/115): src/MyBlog.Infrastructure/Telemetry/FileLogExporter.cs
Processing (58/115): src/MyBlog.Infrastructure/Telemetry/TelemetryPathResolver.cs
Processing (59/115): src/MyBlog.slnx
Processing (60/115): src/MyBlog.Tests/Integration/AuthServiceLongPasswordTests.cs
Processing (61/115): src/MyBlog.Tests/Integration/AuthServiceTests.cs
Processing (62/115): src/MyBlog.Tests/Integration/PasswordChangeTests.cs
Processing (63/115): src/MyBlog.Tests/Integration/PostRepositoryTests.cs
Processing (64/115): src/MyBlog.Tests/Integration/TelemetryCleanupTests.cs
Processing (65/115): src/MyBlog.Tests/MyBlog.Tests.csproj
Processing (66/115): src/MyBlog.Tests/Unit/LoginRateLimitMiddlewareTests.cs
Processing (67/115): src/MyBlog.Tests/Unit/MarkdownServiceTests.cs
Processing (68/115): src/MyBlog.Tests/Unit/PasswordServiceTests.cs
Processing (69/115): src/MyBlog.Tests/Unit/SlugServiceTests.cs
Processing (70/115): src/MyBlog.Web/appsettings.Development.json
Processing (71/115): src/MyBlog.Web/appsettings.json
Processing (72/115): src/MyBlog.Web/Components/App.razor
Processing (73/115): src/MyBlog.Web/Components/_Imports.razor
Processing (74/115): src/MyBlog.Web/Components/Layout/MainLayout.razor
Processing (75/115): src/MyBlog.Web/Components/Pages/About.razor
Processing (76/115): src/MyBlog.Web/Components/Pages/About.razor.css
Processing (77/115): src/MyBlog.Web/Components/Pages/AccessDenied.razor
Processing (78/115): src/MyBlog.Web/Components/Pages/Admin/ChangePassword.razor
Processing (79/115): src/MyBlog.Web/Components/Pages/Admin/ChangePassword.razor.css
Processing (80/115): src/MyBlog.Web/Components/Pages/Admin/Dashboard.razor
Processing (81/115): src/MyBlog.Web/Components/Pages/Admin/Dashboard.razor.css
Processing (82/115): src/MyBlog.Web/Components/Pages/Admin/ImageManager.razor
Processing (83/115): src/MyBlog.Web/Components/Pages/Admin/ImageManager.razor.css
Processing (84/115): src/MyBlog.Web/Components/Pages/Admin/PostEditor.razor
Processing (85/115): src/MyBlog.Web/Components/Pages/Admin/PostEditor.razor.css
Processing (86/115): src/MyBlog.Web/Components/Pages/Admin/PostList.razor
Processing (87/115): src/MyBlog.Web/Components/Pages/Admin/UserEditor.razor
Processing (88/115): src/MyBlog.Web/Components/Pages/Admin/UserEditor.razor.css
Processing (89/115): src/MyBlog.Web/Components/Pages/Admin/UserList.razor
Processing (90/115): src/MyBlog.Web/Components/Pages/Admin/UserList.razor.css
Processing (91/115): src/MyBlog.Web/Components/Pages/Home.razor
Processing (92/115): src/MyBlog.Web/Components/Pages/Login.razor
Processing (93/115): src/MyBlog.Web/Components/Pages/Login.razor.css
Processing (94/115): src/MyBlog.Web/Components/Pages/PostDetail.razor
Processing (95/115): src/MyBlog.Web/Components/Pages/PostDetail.razor.css
Processing (96/115): src/MyBlog.Web/Components/Routes.razor
Processing (97/115): src/MyBlog.Web/Components/Shared/Footer.razor
Processing (98/115): src/MyBlog.Web/Components/Shared/Footer.razor.css
Processing (99/115): src/MyBlog.Web/Components/Shared/MarkdownRenderer.razor
Processing (100/115): src/MyBlog.Web/Components/Shared/Pagination.razor
Processing (101/115): src/MyBlog.Web/Components/Shared/PostCard.razor
Processing (102/115): src/MyBlog.Web/Components/Shared/PostCard.razor.css
Processing (103/115): src/MyBlog.Web/Components/Shared/ReaderBadge.razor
Processing (104/115): src/MyBlog.Web/Components/Shared/ReaderBadge.razor.css
Processing (105/115): src/MyBlog.Web/Components/Shared/RedirectToLogin.razor
Processing (106/115): src/MyBlog.Web/Components/Shared/ThemeSwitcher.razor
Processing (107/115): src/MyBlog.Web/Components/Shared/ThemeSwitcher.razor.css
Processing (108/115): src/MyBlog.Web/Dockerfile
Processing (109/115): src/MyBlog.Web/Hubs/ReaderHub.cs
Processing (110/115): src/MyBlog.Web/Middleware/LoginRateLimitMiddleware.cs
Processing (111/115): src/MyBlog.Web/MyBlog.Web.csproj
Processing (112/115): src/MyBlog.Web/Program.cs
Processing (113/115): src/MyBlog.Web/Properties/launchSettings.json
Processing (114/115): src/MyBlog.Web/wwwroot/css/site.css
Processing (115/115): src/MyBlog.Web/wwwroot/js/site.js

==============================================
  Export Complete!
==============================================

Output file:    docs/llm/dump.txt
Files exported: 115
Files skipped:  0
Output size:    424.78 KB

File types included:
  • Source code: .cs, .fs, .vb
  • Blazor/Razor: .razor
  • UI/XAML: .axaml, .xaml, .paml
  • Projects: .csproj, .slnx, .sln, .props, .targets
  • Config: .json, .yaml, .yml, .xml, .config
  • Docs: .md, .txt
  • Scripts: .sh, .ps1, .cmd, .bat
  • Web: .css, .scss, .js, .ts
  • Other: .sql, .resx, Dockerfile, etc.


real	0m1.175s
user	0m0.708s
sys	0m0.700s
#!/bin/bash
# =============================================================================
# Run E2E Tests with Podman Compose
# =============================================================================
# This script runs Playwright E2E tests against MyBlog using containers.
# Designed for Fedora with SELinux and Podman.
#
# Usage:
#   ./run-e2e.sh          # Run all E2E tests
#   ./run-e2e.sh --build  # Force rebuild containers
#   ./run-e2e.sh --clean  # Clean up and remove volumes
# =============================================================================

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Parse arguments
BUILD_FLAG=""
CLEAN_FLAG=""

for arg in "$@"; do
    case $arg in
        --build)
            BUILD_FLAG="--build"
            ;;
        --clean)
            CLEAN_FLAG="true"
            ;;
    esac
done

# Clean up if requested (manual clean only)
if [ "$CLEAN_FLAG" == "true" ]; then
    log_info "Cleaning up containers and volumes..."
    podman-compose -f docker-compose.e2e.yml down -v --remove-orphans 2>/dev/null || true
    podman system prune -f 2>/dev/null || true
    log_info "Cleanup complete"
    exit 0
fi

# Create test results directory
mkdir -p test-results
# Set SELinux context if on Fedora with SELinux
if command -v chcon &> /dev/null && getenforce 2>/dev/null | grep -q "Enforcing"; then
    log_info "Setting SELinux context for test-results directory..."
    chcon -Rt svirt_sandbox_file_t test-results 2>/dev/null || true
fi

log_info "Starting E2E test environment..."

# FORCE CLEANUP: Ensure we start with a fresh database
# This prevents test failures due to stale data/passwords from previous runs
log_info "Ensuring clean environment..."
podman-compose -f docker-compose.e2e.yml down -v --remove-orphans 2>/dev/null || true
# Explicitly remove the volume to be safe
podman volume rm myblog_myblog-data 2>/dev/null || true

# Build and start services
log_info "Building containers..."
podman-compose -f docker-compose.e2e.yml build $BUILD_FLAG

log_info "Starting MyBlog web service..."
podman-compose -f docker-compose.e2e.yml up -d myblog-web

# Wait for web service to be healthy
log_info "Waiting for MyBlog to be ready..."
RETRIES=30
until podman exec myblog-web curl -sf http://localhost:5000/ > /dev/null 2>&1; do
    RETRIES=$((RETRIES - 1))
    if [ $RETRIES -eq 0 ]; then
        log_error "MyBlog failed to start within timeout"
        podman-compose -f docker-compose.e2e.yml logs myblog-web
        podman-compose -f docker-compose.e2e.yml down -v
        exit 1
    fi
    echo -n "."
    sleep 2
done
echo ""
log_info "MyBlog is ready!"

# Run E2E tests
log_info "Running E2E tests..."
podman-compose -f docker-compose.e2e.yml up myblog-e2e
E2E_EXIT_CODE=$?

# Capture logs
log_info "Capturing logs..."
podman-compose -f docker-compose.e2e.yml logs myblog-web > test-results/myblog-web.log 2>&1
podman-compose -f docker-compose.e2e.yml logs myblog-e2e > test-results/myblog-e2e.log 2>&1

# Clean up
log_info "Cleaning up..."
podman-compose -f docker-compose.e2e.yml down -v

if [ $E2E_EXIT_CODE -eq 0 ]; then
    log_info "E2E tests passed! ✓"
else
    log_error "E2E tests failed with exit code $E2E_EXIT_CODE"
    log_info "Check test-results/ directory for logs"
fi

exit $E2E_EXIT_CODE
[INFO] Cleaning up containers and volumes...
Deleted Images
5a36d61f244af10498873a8c3780d8210e3b336fc2460f5320f8bceaf869a2d5
95920e2cc478a7cbe9a5f703a07bc910167ed57f6aca8b56b513ebb0222154d6
34fb49c5f017c828d5ac1ed7329e8de294b26aecb0541bd230f1bafd3fd451ed
653a0cc7ae23a9541d7015b551e25241eff34789fcac177396799a3254e7d255
d2eda38622c7215e1c4e90f75ec6931e81fad76e50e1fcb6e991b957e1d4786e
b0d838adc3c4135b821722300191ef8a3be3f0a163667b30bca4de85a19c56d5
de32083c01d2c9a9166aeb58782e401a5d024858d4eee83b2f53ffcd3f5a665e
04f930be3676377c688b84c647d42b3fa2fb9b04597ad23aa44395c192bc175e
16d9e0e10ce8acf78843f81867bb0e7cba0af969b28c4b2ae180fb9a59f93685
9c7f2fecebf058d30600092d30a9b8b2846692d2793d9a0b9a793bd8847a4a6e
d71ba2dee291ab0c4035c9bcad6a211a3832b4961320fadfd0327b37b39c7651
20e1d4e3a3a37cffb8ecc94bed8bc45a9d132ff629dc5fc8785b28f3290adf19
d193ce4c2143f346da04c7cb97fa46c4a78e9bb4d01f9304d964c76c59a9f78f
f93f2001aa7781816bb79242999c8d37fcc9b9e4c0bb619a79ab446880257da9
ba7142edec3c8c14325f1f5a1d47bb3f81e0c4c0169570daf83be0ca8a236da5
680235886ce1c52134be9d20738c632385c1e1fe77d2710007e282ff9cf427b4
7e78f3b5c9c71708435cba166a8692d4cdcb68855984927041194bd6f3bc9ad5
47d342d6005de8eda559042d77ea62135ff09e04bfe73c2b114cb9aaef110b4e
12ab224b9e23ddc1ae799302ebbc9077129adf918146ead979d9f368ce2bfe87
dfac0f27a554fda10ad373112306310e6cc22fd4aeabea7a2f330d4cac692381
475304d6c223a899425aaacc059dcc3ff05efff5b7334af009094a798dd8d980
2119b113e4195493eb2abe4ad4bc9d350c7950d3860423ead8b4752d1b65a200
dc9ec85ec8d462a45bd1ce335f1a5f3555e8daae7faf45f63c861f1dd8271ea7
cff7a9f3537f1a2809273804cf5223e9c6ca88afb09f38c896c3320cc42e1222
2d033e5a793319e07da465d314d7a8a4ce1a21ad55666499be812b3f43169c5f
Total reclaimed space: 38.47GB
[INFO] Cleanup complete

real	0m0.939s
user	0m0.545s
sys	0m0.530s
[INFO] Setting SELinux context for test-results directory...
[INFO] Starting E2E test environment...
[INFO] Ensuring clean environment...
[INFO] Building containers...
STEP 1/18: FROM mcr.microsoft.com/dotnet/sdk:10.0-noble
[1/2] STEP 1/12: FROM mcr.microsoft.com/dotnet/sdk:10.0 AS build
STEP 2/18: WORKDIR /src
--> Using cache 1a780d16107a5473ff68e88b71349c8f166e0a15db185a4d39d77990dcac7ba6
--> 1a780d16107a
STEP 3/18: RUN apt-get update &&     apt-get install -y --no-install-recommends     wget     curl     gnupg     ca-certificates     fonts-liberation     libasound2t64     libatk-bridge2.0-0     libatk1.0-0     libatspi2.0-0     libcairo2     libcups2     libdbus-1-3     libdrm2     libgbm1     libglib2.0-0     libgtk-3-0     libnspr4     libnss3     libpango-1.0-0     libx11-6     libxcb1     libxcomposite1     libxdamage1     libxext6     libxfixes3     libxkbcommon0     libxrandr2     xdg-utils     && rm -rf /var/lib/apt/lists/*
--> Using cache 35dd6a4680b2e84a470a64e7bc1012964c4b139742311026d816ea3cf297c777
--> 35dd6a4680b2
STEP 4/18: RUN wget -q https://packages.microsoft.com/config/ubuntu/24.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb &&     dpkg -i packages-microsoft-prod.deb &&     rm packages-microsoft-prod.deb &&     apt-get update &&     apt-get install -y --no-install-recommends powershell &&     rm -rf /var/lib/apt/lists/*
--> Using cache 9f435cb0092a6e44d88dc2369863fb839a203b7c97f9f70dfc0aad8bd630a111
--> 9f435cb0092a
STEP 5/18: COPY Directory.Build.props .
--> Using cache d2ca33dfcd77dbd49a8a7c64af9d12933c2a10d8c945f0b7f20a464ad989eda8
--> d2ca33dfcd77
STEP 6/18: COPY Directory.Packages.props .
--> Using cache 5410d5936386382118681074c2fee859a37a40abf43236883bc6a99d06caa3d2
--> 5410d5936386
STEP 7/18: COPY MyBlog.Core/MyBlog.Core.csproj MyBlog.Core/
--> Using cache 3e796636dcd44934c1aea2efc8fa3083034df9dacb1437f111809dc86ae58224
--> 3e796636dcd4
STEP 8/18: COPY MyBlog.Infrastructure/MyBlog.Infrastructure.csproj MyBlog.Infrastructure/
[1/2] STEP 2/12: WORKDIR /src
--> dbcc77033618
[1/2] STEP 3/12: COPY Directory.Build.props .
--> Using cache afc5f754a25bba925873b74f9a59fc474a26c20e4c55a5d27faa4d7fafe800bc
--> afc5f754a25b
STEP 9/18: COPY MyBlog.Web/MyBlog.Web.csproj MyBlog.Web/
--> 331dcb7f1b32
[1/2] STEP 4/12: COPY Directory.Packages.props .
--> Using cache c127eb96fadfe7700443760448c86dd771911eeb8f026d0ed2f641d04e516ed6
--> c127eb96fadf
STEP 10/18: COPY MyBlog.E2E/MyBlog.E2E.csproj MyBlog.E2E/
--> Using cache fa8071ffb092e2330b1dce46252ddc3b98d13e027c99b23865952bf67cffae32
--> fa8071ffb092
STEP 11/18: RUN dotnet restore MyBlog.Core/MyBlog.Core.csproj &&     dotnet restore MyBlog.Infrastructure/MyBlog.Infrastructure.csproj &&     dotnet restore MyBlog.Web/MyBlog.Web.csproj &&     dotnet restore MyBlog.E2E/MyBlog.E2E.csproj
--> Using cache 24f5bd25ac8947b04485371a978ee117590869a81dd3c22a2baf665a9c47dcd6
--> 24f5bd25ac89
STEP 12/18: COPY . .
--> f879b7a255d1
[1/2] STEP 5/12: COPY MyBlog.Core/MyBlog.Core.csproj MyBlog.Core/
--> f344d7f522cb
[1/2] STEP 6/12: COPY MyBlog.Infrastructure/MyBlog.Infrastructure.csproj MyBlog.Infrastructure/
--> 256511b3a7ed
[1/2] STEP 7/12: COPY MyBlog.Web/MyBlog.Web.csproj MyBlog.Web/
--> 68fdb78ec0e3
[1/2] STEP 8/12: RUN dotnet restore MyBlog.Web/MyBlog.Web.csproj
  Determining projects to restore...
--> c5a4e8da0b08
STEP 13/18: RUN dotnet build MyBlog.E2E/MyBlog.E2E.csproj -c Release
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 1.58 sec).
  Determining projects to restore...
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 2.07 sec).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 2.5 sec).
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 437 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 439 ms).
  Restored /src/MyBlog.E2E/MyBlog.E2E.csproj (in 445 ms).
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 617 ms).
--> b3b5bba1f5b1
[1/2] STEP 9/12: COPY MyBlog.Core/ MyBlog.Core/
--> e43468ccabce
[1/2] STEP 10/12: COPY MyBlog.Infrastructure/ MyBlog.Infrastructure/
--> 4b9973238560
[1/2] STEP 11/12: COPY MyBlog.Web/ MyBlog.Web/
--> d0a155912bfa
[1/2] STEP 12/12: RUN dotnet publish MyBlog.Web/MyBlog.Web.csproj -c Release -o /app/publish
  Determining projects to restore...
  MyBlog.Core -> /src/MyBlog.Core/bin/Release/net10.0/MyBlog.Core.dll
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 180 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 182 ms).
  MyBlog.Infrastructure -> /src/MyBlog.Infrastructure/bin/Release/net10.0/MyBlog.Infrastructure.dll
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 536 ms).
  MyBlog.Web -> /src/MyBlog.Web/bin/Release/net10.0/MyBlog.Web.dll
  MyBlog.E2E -> /src/MyBlog.E2E/bin/Release/net10.0/MyBlog.E2E.dll

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:08.43
  MyBlog.Core -> /src/MyBlog.Core/bin/Release/net10.0/MyBlog.Core.dll
  MyBlog.Infrastructure -> /src/MyBlog.Infrastructure/bin/Release/net10.0/MyBlog.Infrastructure.dll
--> 73007bd2b0e2
STEP 14/18: RUN pwsh ./MyBlog.E2E/bin/Release/net10.0/playwright.ps1 install chromium
Downloading Chromium 143.0.7499.4 (playwright build v1200) from https://cdn.playwright.dev/dbazure/download/playwright/builds/chromium/1200/chromium-linux.zip
(node:34) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 164.7 MiB
|■■■■■■■■                                                                        |  10% of 164.7 MiB
  MyBlog.Web -> /src/MyBlog.Web/bin/Release/net10.0/MyBlog.Web.dll
  MyBlog.Web -> /app/publish/
|■■■■■■■■■■■■■■■■                                                                |  20% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 164.7 MiB
--> 8c34361a9ea3
[2/2] STEP 1/12: FROM mcr.microsoft.com/dotnet/aspnet:10.0 AS runtime
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 164.7 MiB
[2/2] STEP 2/12: WORKDIR /app
--> Using cache 7ab200e45b1fba59b74177866b30af0761e035beacbc6a5d1607edc1b649f36a
--> 7ab200e45b1f
[2/2] STEP 3/12: RUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/*
--> Using cache 1e21b972573d10c4ea9d7b8076e58aed09bb9967e8ee6d5a8c3c77e2cddd1001
--> 1e21b972573d
[2/2] STEP 4/12: RUN useradd -m -s /bin/bash appuser
--> Using cache 7b0ba419cc37495396a1969cd185514b97ee464988ce4bddc954893f0ac664d5
--> 7b0ba419cc37
[2/2] STEP 5/12: RUN mkdir -p /app/data && chown appuser:appuser /app/data
--> Using cache 1a52159880ea26e77195a71342eb88df7e9cb2112f4b48a28ce51dfc69734231
--> 1a52159880ea
[2/2] STEP 6/12: COPY --from=build /app/publish .
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 164.7 MiB
--> 26061e47a8d6
[2/2] STEP 7/12: ENV ASPNETCORE_URLS=http://+:5000
--> 0de4f3eb687a
[2/2] STEP 8/12: ENV ASPNETCORE_ENVIRONMENT=Production
--> e4d04ba63231
[2/2] STEP 9/12: ENV ConnectionStrings__DefaultConnection="Data Source=/app/data/myblog.db"
--> 1c95c39d8de5
[2/2] STEP 10/12: USER appuser
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 164.7 MiB
--> c692fe991b48
[2/2] STEP 11/12: EXPOSE 5000
--> c81945f14ad8
[2/2] STEP 12/12: ENTRYPOINT ["dotnet", "MyBlog.Web.dll"]
[2/2] COMMIT myblog_myblog-web
--> 72a49f4eac2c
Successfully tagged localhost/myblog_myblog-web:latest
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 164.7 MiB
72a49f4eac2cba0959f5c9512efe3aa3d59b8541396f86dc76c25bba5e7f1427
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 164.7 MiB
Chromium 143.0.7499.4 (playwright build v1200) downloaded to /root/.cache/ms-playwright/chromium-1200
Downloading FFMPEG playwright build v1011 from https://cdn.playwright.dev/dbazure/download/playwright/builds/ffmpeg/1011/ffmpeg-linux.zip
(node:45) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 2.3 MiB
|■■■■■■■■                                                                        |  10% of 2.3 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 2.3 MiB
FFMPEG playwright build v1011 downloaded to /root/.cache/ms-playwright/ffmpeg-1011
Downloading Chromium Headless Shell 143.0.7499.4 (playwright build v1200) from https://cdn.playwright.dev/dbazure/download/playwright/builds/chromium/1200/chromium-headless-shell-linux.zip
(node:56) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 109.7 MiB
|■■■■■■■■                                                                        |  10% of 109.7 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 109.7 MiB
Chromium Headless Shell 143.0.7499.4 (playwright build v1200) downloaded to /root/.cache/ms-playwright/chromium_headless_shell-1200
--> 9ce8a619af73
STEP 15/18: WORKDIR /src/MyBlog.E2E
--> 04f53a5a31b5
STEP 16/18: ENV MYBLOG_BASE_URL=http://myblog-web:5000
--> 1c84d5ccd13a
STEP 17/18: ENV PLAYWRIGHT_HEADLESS=true
--> 14ba852d3f87
STEP 18/18: ENTRYPOINT ["dotnet", "run", "-c", "Release", "--no-build"]
COMMIT myblog_myblog-e2e
--> 6f482e82cc4b
Successfully tagged localhost/myblog_myblog-e2e:latest
6f482e82cc4b6476d43c5ace4a155b25c3517c4712c85fbafa19bf322fb2a0a6
[INFO] Starting MyBlog web service...
2a40bccc89c8c94fda589fc27641b3686cfe6846db283a9767ce833c2413d272
95ce2d8c3877b581cccb3cdfc55c6c97f4b72ef23ac8bfdef3e5db3e46d47a3c
myblog-web
[INFO] Waiting for MyBlog to be ready...
.
[INFO] MyBlog is ready!
[INFO] Running E2E tests...
11f203b0361071f789a734952e9c8cd95ccb018f1141401d05e93d06a5823355
[myblog-web] | cannot open `/run/user/1000/crun/95ce2d8c3877b581cccb3cdfc55c6c97f4b72ef23ac8bfdef3e5db3e46d47a3c/exec.fifo`: No such file or directory
[myblog-web] | Error: unable to start container 95ce2d8c3877b581cccb3cdfc55c6c97f4b72ef23ac8bfdef3e5db3e46d47a3c: `/usr/bin/crun start 95ce2d8c3877b581cccb3cdfc55c6c97f4b72ef23ac8bfdef3e5db3e46d47a3c` failed: exit status 1
[myblog-e2e] | xUnit.net v3 In-Process Runner v3.2.2+728c1dce01 (64-bit .NET 10.0.1)
[myblog-e2e] |   Discovering: MyBlog.E2E
[myblog-e2e] |   Discovered:  MyBlog.E2E
[myblog-e2e] |   Starting:    MyBlog.E2E
[myblog-e2e] |     MyBlog.E2E.Tests.LoginPageTests.LoginPage_AfterLogin_ShowsLogoutButton [FAIL]
[myblog-e2e] |       Microsoft.Playwright.PlaywrightException : Page URL expected to match regex '/admin'
[myblog-e2e] |       But was: 'http://myblog-web:5000/login' 
[myblog-e2e] |       Call log:
[myblog-e2e] |         - Expect "ToHaveURLAsync" with timeout 5000ms
[myblog-e2e] |           9 × unexpected value "http://myblog-web:5000/login"
[myblog-e2e] |       Stack Trace:
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(92,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, FrameExpectOptions expectOptions, Object expected, String message, String title)
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(66,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, ExpectedTextValue[] expectedText, Object expected, String message, String title, FrameExpectOptions options)
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(58,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, ExpectedTextValue textValue, Object expected, String message, String title, FrameExpectOptions options)
[myblog-e2e] |         Tests/LoginPageTests.cs(82,0): at MyBlog.E2E.Tests.LoginPageTests.LoginPage_AfterLogin_ShowsLogoutButton()
[myblog-e2e] |         --- End of stack trace from previous location ---
[myblog-e2e] |     MyBlog.E2E.Tests.LoginPageTests.LoginPage_WithValidCredentials_RedirectsToAdmin [FAIL]
[myblog-e2e] |       Microsoft.Playwright.PlaywrightException : Page URL expected to match regex '/admin'
[myblog-e2e] |       But was: 'http://myblog-web:5000/login' 
[myblog-e2e] |       Call log:
[myblog-e2e] |         - Expect "ToHaveURLAsync" with timeout 5000ms
[myblog-e2e] |           9 × unexpected value "http://myblog-web:5000/login"
[myblog-e2e] |       Stack Trace:
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(92,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, FrameExpectOptions expectOptions, Object expected, String message, String title)
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(66,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, ExpectedTextValue[] expectedText, Object expected, String message, String title, FrameExpectOptions options)
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(58,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, ExpectedTextValue textValue, Object expected, String message, String title, FrameExpectOptions options)
[myblog-e2e] |         Tests/LoginPageTests.cs(66,0): at MyBlog.E2E.Tests.LoginPageTests.LoginPage_WithValidCredentials_RedirectsToAdmin()
[myblog-e2e] |         --- End of stack trace from previous location ---
[myblog-e2e] |     MyBlog.E2E.Tests.LoginPageTests.LoginPage_WithInvalidCredentials_ShowsError [FAIL]
[myblog-e2e] |       Microsoft.Playwright.PlaywrightException : Locator expected to be visible
[myblog-e2e] |       Error: element(s) not found 
[myblog-e2e] |       Call log:
[myblog-e2e] |         - Expect "ToBeVisibleAsync" with timeout 5000ms
[myblog-e2e] |         - waiting for Locator(".error-message")
[myblog-e2e] |       Stack Trace:
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(90,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, FrameExpectOptions expectOptions, Object expected, String message, String title)
[myblog-e2e] |         /_/src/Playwright/Core/AssertionsBase.cs(66,0): at Microsoft.Playwright.Core.AssertionsBase.ExpectImplAsync(String expression, ExpectedTextValue[] expectedText, Object expected, String message, String title, FrameExpectOptions options)
[myblog-e2e] |         Tests/LoginPageTests.cs(48,0): at MyBlog.E2E.Tests.LoginPageTests.LoginPage_WithInvalidCredentials_ShowsError()
[myblog-e2e] |         --- End of stack trace from previous location ---
[myblog-e2e] |   Finished:    MyBlog.E2E (ID = '4d488734a9156ea8719a93bca3e9cb47dfeac4715a7981582060bf185a1e7bf4')
[myblog-e2e] | === TEST EXECUTION SUMMARY ===
[myblog-e2e] |    MyBlog.E2E  Total: 18, Errors: 0, Failed: 3, Skipped: 0, Not Run: 0, Time: 21.222s
[myblog-e2e] | 
[INFO] Capturing logs...
[INFO] Cleaning up...
myblog-e2e
myblog-web
myblog-e2e
myblog-web
myblog_myblog-data
2a40bccc89c8c94fda589fc27641b3686cfe6846db283a9767ce833c2413d272
myblog_myblog-network
[INFO] E2E tests passed! ✓

real	1m0.348s
user	0m32.104s
sys	0m16.638s
kushal@fedora:~/src/dotnet/MyBlog$ 
