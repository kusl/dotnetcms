can you fix it? I will give you all the context you need give me full file for any file that needs to change please and thank you 

I can see the issue! Your E2E tests are failing because the web application isn't starting up properly before the tests run. The problem is in your GitHub Actions workflow - the application is being started in the background, but it's not staying alive long enough for the tests to run.

Here's the corrected workflow file:## Key Changes Made:

1. **Proper application startup**: The app now starts with output redirected to `app.log` and the process ID saved to `app.pid`

2. **Better health check**: Extended timeout to 60 attempts (2 minutes total) with better logging to help diagnose startup issues

3. **Full solution build**: Added `dotnet restore` and `dotnet build` for the entire solution in the e2e-tests job to ensure all dependencies are built

4. **Application lifecycle management**: 
   - Saves the PID so the app can be properly stopped
   - Includes a cleanup step that runs even if tests fail
   - Captures application logs on failure for debugging

5. **Deploy dependency**: Changed deploy to depend on both `build-test` AND `e2e-tests` so it only deploys if E2E tests pass

6. **Log artifacts**: Application logs are now uploaded with test results for debugging

The main issue was that your app was starting in the background but the process wasn't being kept alive properly. The new approach redirects output to a log file and saves the PID so the process stays running throughout the test execution.








```yaml
name: Build, Test, and Deploy

on:
  push:
    branches: ['**']
  pull_request:
    branches: ['**']

jobs:
  build-test:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ${{ matrix.os }}
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 10
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Restore dependencies
        run: dotnet restore src/MyBlog.slnx

      - name: Build solution
        run: dotnet build src/MyBlog.slnx -c Release --no-restore

      - name: Run unit tests
        run: dotnet run --project src/MyBlog.Tests/MyBlog.Tests.csproj

  e2e-tests:
    runs-on: ubuntu-latest
    needs: build-test
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 10
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Restore dependencies
        run: dotnet restore src/MyBlog.slnx

      - name: Build solution
        run: dotnet build src/MyBlog.slnx -c Release --no-restore

      - name: Install Playwright browsers
        run: |
          pwsh src/MyBlog.E2E/bin/Release/net10.0/playwright.ps1 install chromium --with-deps

      - name: Start MyBlog application
        run: |
          dotnet run --project src/MyBlog.Web/MyBlog.Web.csproj -c Release --no-build > app.log 2>&1 &
          echo $! > app.pid
        env:
          ASPNETCORE_URLS: http://localhost:5000
          ASPNETCORE_ENVIRONMENT: Development
          Authentication__DefaultAdminPassword: ChangeMe123!

      - name: Wait for application to be ready
        run: |
          echo "Waiting for application to start..."
          for i in {1..60}; do
            if curl -sf http://localhost:5000/ > /dev/null 2>&1; then
              echo "Application is ready!"
              curl -v http://localhost:5000/ 2>&1 | head -20
              break
            fi
            echo "Attempt $i/60: Application not ready yet..."
            sleep 2
            if [ $i -eq 60 ]; then
              echo "Application failed to start within timeout"
              echo "Application logs:"
              cat app.log || echo "No logs available"
              exit 1
            fi
          done

      - name: Run E2E tests
        run: dotnet run --project src/MyBlog.E2E/MyBlog.E2E.csproj -c Release --no-build
        env:
          MYBLOG_BASE_URL: http://localhost:5000
          PLAYWRIGHT_HEADLESS: true

      - name: Stop application
        if: always()
        run: |
          if [ -f app.pid ]; then
            kill $(cat app.pid) || true
          fi

      - name: Show application logs on failure
        if: failure()
        run: |
          echo "=== Application Logs ==="
          cat app.log || echo "No logs available"

      - name: Upload test results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: e2e-test-results
          path: |
            src/MyBlog.E2E/TestResults/
            test-results/
            app.log
          retention-days: 7

  deploy:
    needs: [build-test, e2e-tests]
    if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master' || github.ref == 'refs/heads/develop'
    runs-on: windows-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 10
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Publish application
        run: dotnet publish src/MyBlog.Web/MyBlog.Web.csproj -c Release -o ./publish -r win-x86 --self-contained false

      - name: Deploy via WebDeploy
        shell: pwsh
        env:
          DEPLOY_SOURCE: ${{ github.workspace }}\publish
          DEPLOY_SITE: ${{ secrets.WEBSITE_NAME }}
          DEPLOY_HOST: ${{ secrets.SERVER_COMPUTER_NAME }}
          DEPLOY_USER: ${{ secrets.SERVER_USERNAME }}
          DEPLOY_PASSWORD: ${{ secrets.SERVER_PASSWORD }}
        run: |
          $msdeployPath = "C:\Program Files\IIS\Microsoft Web Deploy V3\msdeploy.exe"
          
          if (-not (Test-Path $msdeployPath)) {
            Write-Host "Installing Web Deploy..."
            choco install webdeploy -y --no-progress
          }
          
          Write-Host "Deploying to $env:DEPLOY_HOST..."
          Write-Host "Note: Using AppOffline rule to prevent file-in-use errors"

          $sourceArg = "-source:contentPath=$env:DEPLOY_SOURCE"
          $destArg = "-dest:contentPath=$env:DEPLOY_SITE,computerName=https://$($env:DEPLOY_HOST):8172/MsDeploy.axd?site=$env:DEPLOY_SITE,userName=$env:DEPLOY_USER,password=$env:DEPLOY_PASSWORD,AuthType='Basic'"
          
          & $msdeployPath -verb:sync $sourceArg $destArg `
            -allowUntrusted `
            -enableRule:DoNotDeleteRule `
            -enableRule:AppOffline `
            -retryAttempts:3 `
            -retryInterval:3000
          
          if ($LASTEXITCODE -ne 0) {
            Write-Error "Deployment failed with exit code $LASTEXITCODE"
            exit 1
          }
          
          Write-Host "Deployment completed successfully!"
```


Run echo "Waiting for application to start..."
Waiting for application to start...
Attempt 1/60: Application not ready yet...
Attempt 2/60: Application not ready yet...
Attempt 3/60: Application not ready yet...
Attempt 4/60: Application not ready yet...
Attempt 5/60: Application not ready yet...
Attempt 6/60: Application not ready yet...
Attempt 7/60: Application not ready yet...
Attempt 8/60: Application not ready yet...
Attempt 9/60: Application not ready yet...
Attempt 10/60: Application not ready yet...
Attempt 11/60: Application not ready yet...
Attempt 12/60: Application not ready yet...
Attempt 13/60: Application not ready yet...
Attempt 14/60: Application not ready yet...
Attempt 15/60: Application not ready yet...
Attempt 16/60: Application not ready yet...
Attempt 17/60: Application not ready yet...
Attempt 18/60: Application not ready yet...
Attempt 19/60: Application not ready yet...
Attempt 20/60: Application not ready yet...
Attempt 21/60: Application not ready yet...
Attempt 22/60: Application not ready yet...
Attempt 23/60: Application not ready yet...
Attempt 24/60: Application not ready yet...
Attempt 25/60: Application not ready yet...
Attempt 26/60: Application not ready yet...
Attempt 27/60: Application not ready yet...
Attempt 28/60: Application not ready yet...
Attempt 29/60: Application not ready yet...
Attempt 30/60: Application not ready yet...
Attempt 31/60: Application not ready yet...
Attempt 32/60: Application not ready yet...
Attempt 33/60: Application not ready yet...
Attempt 34/60: Application not ready yet...
Attempt 35/60: Application not ready yet...
Attempt 36/60: Application not ready yet...
Attempt 37/60: Application not ready yet...
Attempt 38/60: Application not ready yet...
Attempt 39/60: Application not ready yet...
Attempt 40/60: Application not ready yet...
Attempt 41/60: Application not ready yet...
Attempt 42/60: Application not ready yet...
Attempt 43/60: Application not ready yet...
Attempt 44/60: Application not ready yet...
Attempt 45/60: Application not ready yet...
Attempt 46/60: Application not ready yet...
Attempt 47/60: Application not ready yet...
Attempt 48/60: Application not ready yet...
Attempt 49/60: Application not ready yet...
Attempt 50/60: Application not ready yet...
Attempt 51/60: Application not ready yet...
Attempt 52/60: Application not ready yet...
Attempt 53/60: Application not ready yet...
Attempt 54/60: Application not ready yet...
Attempt 55/60: Application not ready yet...
Attempt 56/60: Application not ready yet...
Attempt 57/60: Application not ready yet...
Attempt 58/60: Application not ready yet...
Attempt 59/60: Application not ready yet...
Attempt 60/60: Application not ready yet...
Application failed to start within timeout
Application logs:
Using launch settings from src/MyBlog.Web/Properties/launchSettings.json...
info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[62]
      User profile is available. Using '/home/runner/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
LogRecord.Timestamp:               2026-01-27T18:12:43.7163629Z
LogRecord.CategoryName:            Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        User profile is available. Using '/home/runner/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
LogRecord.Body:                    User profile is available. Using '{FullName}' as key repository; keys will not be encrypted at rest.
LogRecord.Attributes (Key:Value):
    FullName: /home/runner/.aspnet/DataProtection-Keys
    OriginalFormat (a.k.a Body): User profile is available. Using '{FullName}' as key repository; keys will not be encrypted at rest.
LogRecord.EventId:                 62
LogRecord.EventName:               UsingProfileAsKeyRepository

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

dbug: Microsoft.Extensions.Hosting.Internal.Host[1]
      Hosting starting
LogRecord.Timestamp:               2026-01-27T18:12:45.1044676Z
LogRecord.CategoryName:            Microsoft.Extensions.Hosting.Internal.Host
LogRecord.Severity:                Debug
LogRecord.SeverityText:            Debug
LogRecord.FormattedMessage:        Hosting starting
LogRecord.Body:                    Hosting starting
LogRecord.Attributes (Key:Value):
    OriginalFormat (a.k.a Body): Hosting starting
LogRecord.EventId:                 1
LogRecord.EventName:               Starting

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[58]
      Creating key {2e37cea9-49e7-4a02-8fc9-311a64575860} with creation date 2026-01-27 18:12:45Z, activation date 2026-01-27 18:12:45Z, and expiration date 2026-04-27 18:12:45Z.
LogRecord.Timestamp:               2026-01-27T18:12:45.1700222Z
LogRecord.CategoryName:            Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Creating key {2e37cea9-49e7-4a02-8fc9-311a64575860} with creation date 2026-01-27 18:12:45Z, activation date 2026-01-27 18:12:45Z, and expiration date 2026-04-27 18:12:45Z.
LogRecord.Body:                    Creating key {KeyId:B} with creation date {CreationDate:u}, activation date {ActivationDate:u}, and expiration date {ExpirationDate:u}.
LogRecord.Attributes (Key:Value):
    KeyId: 2e37cea9-49e7-4a02-8fc9-311a64575860
    CreationDate: 01/27/2026 18:12:45 +00:00
    ActivationDate: 01/27/2026 18:12:45 +00:00
    ExpirationDate: 04/27/2026 18:12:45 +00:00
    OriginalFormat (a.k.a Body): Creating key {KeyId:B} with creation date {CreationDate:u}, activation date {ActivationDate:u}, and expiration date {ExpirationDate:u}.
LogRecord.EventId:                 58
LogRecord.EventName:               CreatingKey

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

warn: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[35]
      No XML encryptor configured. Key {2e37cea9-49e7-4a02-8fc9-311a64575860} may be persisted to storage in unencrypted form.
LogRecord.Timestamp:               2026-01-27T18:12:45.1917255Z
LogRecord.CategoryName:            Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager
LogRecord.Severity:                Warn
LogRecord.SeverityText:            Warning
LogRecord.FormattedMessage:        No XML encryptor configured. Key {2e37cea9-49e7-4a02-8fc9-311a64575860} may be persisted to storage in unencrypted form.
LogRecord.Body:                    No XML encryptor configured. Key {KeyId:B} may be persisted to storage in unencrypted form.
LogRecord.Attributes (Key:Value):
    KeyId: 2e37cea9-49e7-4a02-8fc9-311a64575860
    OriginalFormat (a.k.a Body): No XML encryptor configured. Key {KeyId:B} may be persisted to storage in unencrypted form.
LogRecord.EventId:                 35
LogRecord.EventName:               NoXMLEncryptorConfiguredKeyMayBePersistedToStorageInUnencryptedForm

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository[39]
      Writing data to file '/home/runner/.aspnet/DataProtection-Keys/key-2e37cea9-49e7-4a02-8fc9-311a64575860.xml'.
LogRecord.Timestamp:               2026-01-27T18:12:45.1946194Z
LogRecord.CategoryName:            Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Writing data to file '/home/runner/.aspnet/DataProtection-Keys/key-2e37cea9-49e7-4a02-8fc9-311a64575860.xml'.
LogRecord.Body:                    Writing data to file '{FileName}'.
LogRecord.Attributes (Key:Value):
    FileName: /home/runner/.aspnet/DataProtection-Keys/key-2e37cea9-49e7-4a02-8fc9-311a64575860.xml
    OriginalFormat (a.k.a Body): Writing data to file '{FileName}'.
LogRecord.EventId:                 39
LogRecord.EventName:               WritingDataToFile

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

warn: Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer[8]
      The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
LogRecord.Timestamp:               2026-01-27T18:12:45.5105951Z
LogRecord.CategoryName:            Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer
LogRecord.Severity:                Warn
LogRecord.SeverityText:            Warning
LogRecord.FormattedMessage:        The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
LogRecord.Body:                    The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
LogRecord.Attributes (Key:Value):
    OriginalFormat (a.k.a Body): The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
LogRecord.EventId:                 8
LogRecord.EventName:               DeveloperCertificateNotTrusted

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.Hosting.Lifetime[14]
      Now listening on: https://localhost:51226
LogRecord.Timestamp:               2026-01-27T18:12:45.5196987Z
LogRecord.CategoryName:            Microsoft.Hosting.Lifetime
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Now listening on: https://localhost:51226
LogRecord.Body:                    Now listening on: {address}
LogRecord.Attributes (Key:Value):
    address: https://localhost:51226
    OriginalFormat (a.k.a Body): Now listening on: {address}
LogRecord.EventId:                 14
LogRecord.EventName:               ListeningOnAddress

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:51227
LogRecord.Timestamp:               2026-01-27T18:12:45.5198063Z
LogRecord.CategoryName:            Microsoft.Hosting.Lifetime
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Now listening on: http://localhost:51227
LogRecord.Body:                    Now listening on: {address}
LogRecord.Attributes (Key:Value):
    address: http://localhost:51227
    OriginalFormat (a.k.a Body): Now listening on: {address}
LogRecord.EventId:                 14
LogRecord.EventName:               ListeningOnAddress

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
LogRecord.Timestamp:               2026-01-27T18:12:45.5200170Z
LogRecord.CategoryName:            Microsoft.Hosting.Lifetime
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Application started. Press Ctrl+C to shut down.
LogRecord.Body:                    Application started. Press Ctrl+C to shut down.
LogRecord.Attributes (Key:Value):
    OriginalFormat (a.k.a Body): Application started. Press Ctrl+C to shut down.

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
LogRecord.Timestamp:               2026-01-27T18:12:45.5203156Z
LogRecord.CategoryName:            Microsoft.Hosting.Lifetime
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Hosting environment: Development
LogRecord.Body:                    Hosting environment: {EnvName}
LogRecord.Attributes (Key:Value):
    EnvName: Development
    OriginalFormat (a.k.a Body): Hosting environment: {EnvName}

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: Microsoft.Hosting.Lifetime[0]
      Content root path: /home/runner/work/dotnetcms/dotnetcms/src/MyBlog.Web
LogRecord.Timestamp:               2026-01-27T18:12:45.5204287Z
LogRecord.CategoryName:            Microsoft.Hosting.Lifetime
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Content root path: /home/runner/work/dotnetcms/dotnetcms/src/MyBlog.Web
LogRecord.Body:                    Content root path: {ContentRoot}
LogRecord.Attributes (Key:Value):
    ContentRoot: /home/runner/work/dotnetcms/dotnetcms/src/MyBlog.Web
    OriginalFormat (a.k.a Body): Content root path: {ContentRoot}

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

dbug: Microsoft.Extensions.Hosting.Internal.Host[2]
      Hosting started
LogRecord.Timestamp:               2026-01-27T18:12:45.5217589Z
LogRecord.CategoryName:            Microsoft.Extensions.Hosting.Internal.Host
LogRecord.Severity:                Debug
LogRecord.SeverityText:            Debug
LogRecord.FormattedMessage:        Hosting started
LogRecord.Body:                    Hosting started
LogRecord.Attributes (Key:Value):
    OriginalFormat (a.k.a Body): Hosting started
LogRecord.EventId:                 2
LogRecord.EventName:               Started

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: MyBlog.Infrastructure.Services.ImageCacheWarmerService[0]
      Image Cache Warmer started. Scanning posts for uncached images...
LogRecord.Timestamp:               2026-01-27T18:12:50.2061383Z
LogRecord.CategoryName:            MyBlog.Infrastructure.Services.ImageCacheWarmerService
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Image Cache Warmer started. Scanning posts for uncached images...
LogRecord.Body:                    Image Cache Warmer started. Scanning posts for uncached images...
LogRecord.Attributes (Key:Value):
    OriginalFormat (a.k.a Body): Image Cache Warmer started. Scanning posts for uncached images...

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

info: MyBlog.Infrastructure.Services.ImageCacheWarmerService[0]
      Image Cache Warmer: All images are already cached.
LogRecord.Timestamp:               2026-01-27T18:12:50.2759633Z
LogRecord.CategoryName:            MyBlog.Infrastructure.Services.ImageCacheWarmerService
LogRecord.Severity:                Info
LogRecord.SeverityText:            Information
LogRecord.FormattedMessage:        Image Cache Warmer: All images are already cached.
LogRecord.Body:                    Image Cache Warmer: All images are already cached.
LogRecord.Attributes (Key:Value):
    OriginalFormat (a.k.a Body): Image Cache Warmer: All images are already cached.

Resource associated with LogRecord:
service.name: MyBlog
service.namespace: 1.0.0.0
service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
telemetry.sdk.name: opentelemetry
telemetry.sdk.language: dotnet
telemetry.sdk.version: 1.15.0

Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Resource associated with Metrics:
	service.name: MyBlog
	service.namespace: 1.0.0.0
	service.instance.id: 90958bc8-bcfe-41da-bb89-68083d3f08b5
	telemetry.sdk.name: opentelemetry
	telemetry.sdk.language: dotnet
	telemetry.sdk.version: 1.15.0
Error: Process completed with exit code 1.






























































Ah! I see the problem now! The application **is** starting successfully, but it's listening on the **wrong ports**. Look at these lines from the log:

```
Now listening on: https://localhost:51226
Now listening on: http://localhost:51227
```

But your tests are trying to connect to `http://localhost:5000`!

The issue is that the `ASPNETCORE_URLS` environment variable is being **overridden by the launchSettings.json file**. The log shows: `Using launch settings from src/MyBlog.Web/Properties/launchSettings.json...`

Here's the fixed workflow:Perfect! The **key change** is adding the `--no-launch-profile` flag to the `dotnet run` command:

```bash
dotnet run --project src/MyBlog.Web/MyBlog.Web.csproj -c Release --no-build --no-launch-profile
```

This tells .NET to **ignore the launchSettings.json file** and instead use the environment variables you've specified (`ASPNETCORE_URLS: http://localhost:5000`).

Without this flag, .NET uses the ports defined in `launchSettings.json` (which were 51226 and 51227), causing your tests to fail when trying to connect to port 5000.

```yaml
name: Build, Test, and Deploy

on:
  push:
    branches: ['**']
  pull_request:
    branches: ['**']

jobs:
  build-test:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ${{ matrix.os }}
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 10
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Restore dependencies
        run: dotnet restore src/MyBlog.slnx

      - name: Build solution
        run: dotnet build src/MyBlog.slnx -c Release --no-restore

      - name: Run unit tests
        run: dotnet run --project src/MyBlog.Tests/MyBlog.Tests.csproj

  e2e-tests:
    runs-on: ubuntu-latest
    needs: build-test
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 10
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Restore dependencies
        run: dotnet restore src/MyBlog.slnx

      - name: Build solution
        run: dotnet build src/MyBlog.slnx -c Release --no-restore

      - name: Install Playwright browsers
        run: |
          pwsh src/MyBlog.E2E/bin/Release/net10.0/playwright.ps1 install chromium --with-deps

      - name: Start MyBlog application
        run: |
          dotnet run --project src/MyBlog.Web/MyBlog.Web.csproj -c Release --no-build --no-launch-profile > app.log 2>&1 &
          echo $! > app.pid
        env:
          ASPNETCORE_URLS: http://localhost:5000
          ASPNETCORE_ENVIRONMENT: Development
          Authentication__DefaultAdminPassword: ChangeMe123!

      - name: Wait for application to be ready
        run: |
          echo "Waiting for application to start..."
          for i in {1..60}; do
            if curl -sf http://localhost:5000/ > /dev/null 2>&1; then
              echo "Application is ready!"
              curl -v http://localhost:5000/ 2>&1 | head -20
              break
            fi
            echo "Attempt $i/60: Application not ready yet..."
            sleep 2
            if [ $i -eq 60 ]; then
              echo "Application failed to start within timeout"
              echo "Application logs:"
              cat app.log || echo "No logs available"
              exit 1
            fi
          done

      - name: Run E2E tests
        run: dotnet run --project src/MyBlog.E2E/MyBlog.E2E.csproj -c Release --no-build
        env:
          MYBLOG_BASE_URL: http://localhost:5000
          PLAYWRIGHT_HEADLESS: true

      - name: Stop application
        if: always()
        run: |
          if [ -f app.pid ]; then
            kill $(cat app.pid) || true
          fi

      - name: Show application logs on failure
        if: failure()
        run: |
          echo "=== Application Logs ==="
          cat app.log || echo "No logs available"

      - name: Upload test results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: e2e-test-results
          path: |
            src/MyBlog.E2E/TestResults/
            test-results/
            app.log
          retention-days: 7

  deploy:
    needs: [build-test, e2e-tests]
    if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master' || github.ref == 'refs/heads/develop'
    runs-on: windows-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 10
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '10.0.x'

      - name: Publish application
        run: dotnet publish src/MyBlog.Web/MyBlog.Web.csproj -c Release -o ./publish -r win-x86 --self-contained false

      - name: Deploy via WebDeploy
        shell: pwsh
        env:
          DEPLOY_SOURCE: ${{ github.workspace }}\publish
          DEPLOY_SITE: ${{ secrets.WEBSITE_NAME }}
          DEPLOY_HOST: ${{ secrets.SERVER_COMPUTER_NAME }}
          DEPLOY_USER: ${{ secrets.SERVER_USERNAME }}
          DEPLOY_PASSWORD: ${{ secrets.SERVER_PASSWORD }}
        run: |
          $msdeployPath = "C:\Program Files\IIS\Microsoft Web Deploy V3\msdeploy.exe"
          
          if (-not (Test-Path $msdeployPath)) {
            Write-Host "Installing Web Deploy..."
            choco install webdeploy -y --no-progress
          }
          
          Write-Host "Deploying to $env:DEPLOY_HOST..."
          Write-Host "Note: Using AppOffline rule to prevent file-in-use errors"

          $sourceArg = "-source:contentPath=$env:DEPLOY_SOURCE"
          $destArg = "-dest:contentPath=$env:DEPLOY_SITE,computerName=https://$($env:DEPLOY_HOST):8172/MsDeploy.axd?site=$env:DEPLOY_SITE,userName=$env:DEPLOY_USER,password=$env:DEPLOY_PASSWORD,AuthType='Basic'"
          
          & $msdeployPath -verb:sync $sourceArg $destArg `
            -allowUntrusted `
            -enableRule:DoNotDeleteRule `
            -enableRule:AppOffline `
            -retryAttempts:3 `
            -retryInterval:3000
          
          if ($LASTEXITCODE -ne 0) {
            Write-Error "Deployment failed with exit code $LASTEXITCODE"
            exit 1
          }
          
          Write-Host "Deployment completed successfully!"

```










kushal@fedora:~/src/dotnet/MyDesktopApplication$ cd ~/src/dotnet/MyBlog/ && export DOTNET_CLI_TELEMETRY_OPTOUT=1 && (cd src && time dotnet format; time dotnet restore; time dotnet clean; time dotnet build; time dotnet run --project MyBlog.Tests/MyBlog.Tests.csproj; time dotnet list package; time dotnet list package --outdated); cd ~/src/dotnet/MyBlog/ && time bash export.sh; cat run-e2e.sh; time bash run-e2e.sh --clean; time bash run-e2e.sh;

real	0m9.811s
user	0m15.275s
sys	0m1.228s
Restore complete (0.5s)

Build succeeded in 0.6s

real	0m0.804s
user	0m0.896s
sys	0m0.185s

Build succeeded in 0.6s

real	0m0.782s
user	0m0.816s
sys	0m0.215s
Restore complete (0.6s)
  MyBlog.Core net10.0 succeeded (1.0s) → MyBlog.Core/bin/Debug/net10.0/MyBlog.Core.dll
  MyBlog.Infrastructure net10.0 succeeded (0.5s) → MyBlog.Infrastructure/bin/Debug/net10.0/MyBlog.Infrastructure.dll
  MyBlog.Web net10.0 succeeded (2.8s) → MyBlog.Web/bin/Debug/net10.0/MyBlog.Web.dll
  MyBlog.Tests net10.0 succeeded (0.6s) → MyBlog.Tests/bin/Debug/net10.0/MyBlog.Tests.dll
  MyBlog.E2E net10.0 succeeded (0.6s) → MyBlog.E2E/bin/Debug/net10.0/MyBlog.E2E.dll

Build succeeded in 5.7s

real	0m5.866s
user	0m2.852s
sys	0m0.524s
xUnit.net v3 In-Process Runner v3.2.2+728c1dce01 (64-bit .NET 10.0.2)
  Discovering: MyBlog.Tests
  Discovered:  MyBlog.Tests
  Starting:    MyBlog.Tests
  Finished:    MyBlog.Tests (ID = '24cedafe73dab5684218bb3cf04cfd49ae8ce3b87ae799399cb2e301cbc1e755')
=== TEST EXECUTION SUMMARY ===
   MyBlog.Tests  Total: 77, Errors: 0, Failed: 0, Skipped: 0, Not Run: 0, Time: 41.777s

real	0m43.941s
user	0m46.908s
sys	0m0.679s
Restore complete (0.5s)

Build succeeded in 0.6s
Project 'MyBlog.Core' has the following package references
   [net10.0]: 
   Top-level Package                   Requested   Resolved
   > Microsoft.Extensions.Logging      10.0.2      10.0.2  

Project 'MyBlog.E2E' has the following package references
   [net10.0]: 
   Top-level Package             Requested   Resolved
   > Microsoft.NET.Test.Sdk      18.0.1      18.0.1  
   > Microsoft.Playwright        1.57.0      1.57.0  
   > xunit.v3                    3.2.2       3.2.2   

Project 'MyBlog.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                           Requested   Resolved
   > Microsoft.AspNetCore.Identity             2.3.9       2.3.9   
   > Microsoft.EntityFrameworkCore.Sqlite      10.0.2      10.0.2  
   > Microsoft.Extensions.Http                 10.0.2      10.0.2  
   > OpenTelemetry                             1.15.0      1.15.0  

Project 'MyBlog.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > Microsoft.EntityFrameworkCore.Sqlite        10.0.2      10.0.2  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > Microsoft.Testing.Extensions.TrxReport      2.0.2       2.0.2   
   > xunit.v3                                    3.2.2       3.2.2   

Project 'MyBlog.Web' has the following package references
   [net10.0]: 
   Top-level Package                                  Requested    Resolved
   > Microsoft.AspNetCore.App.Internal.Assets   (A)   [10.0.2, )   10.0.2  
   > Microsoft.AspNetCore.SignalR.Client              10.0.2       10.0.2  
   > OpenTelemetry.Exporter.Console                   1.15.0       1.15.0  
   > OpenTelemetry.Extensions.Hosting                 1.15.0       1.15.0  
   > OpenTelemetry.Instrumentation.AspNetCore         1.15.0       1.15.0  
   > OpenTelemetry.Instrumentation.Http               1.15.0       1.15.0  

(A) : Auto-referenced package.

real	0m1.838s
user	0m1.828s
sys	0m0.426s
Restore complete (0.5s)

Build succeeded in 0.6s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyBlog.Core` has no updates given the current sources.
The given project `MyBlog.E2E` has no updates given the current sources.
The given project `MyBlog.Infrastructure` has no updates given the current sources.
The given project `MyBlog.Tests` has no updates given the current sources.
The given project `MyBlog.Web` has no updates given the current sources.

real	0m3.256s
user	0m2.421s
sys	0m0.465s
==============================================
  Project Export for LLM Analysis
==============================================

Project Path: /home/kushal/src/dotnet/MyBlog
Output File:  docs/llm/dump.txt

Generating directory structure...
Collecting files...
Found 115 files to export

Processing (1/115): docker-compose.e2e.yml
Processing (2/115): docker-compose.yml
Processing (3/115): .editorconfig
Processing (4/115): export.sh
Processing (5/115): .github/workflows/build-deploy.yml
Processing (6/115): .gitignore
Processing (7/115): README.md
Processing (8/115): run-e2e.sh
Processing (9/115): src/Directory.Build.props
Processing (10/115): src/Directory.Packages.props
Processing (11/115): src/.github/workflows/build-deploy.yml
Processing (12/115): src/global.json
Processing (13/115): src/MyBlog.Core/Constants/AppConstants.cs
Processing (14/115): src/MyBlog.Core/Interfaces/IAuthService.cs
Processing (15/115): src/MyBlog.Core/Interfaces/IImageDimensionService.cs
Processing (16/115): src/MyBlog.Core/Interfaces/IImageRepository.cs
Processing (17/115): src/MyBlog.Core/Interfaces/IMarkdownService.cs
Processing (18/115): src/MyBlog.Core/Interfaces/IPasswordService.cs
Processing (19/115): src/MyBlog.Core/Interfaces/IPostRepository.cs
Processing (20/115): src/MyBlog.Core/Interfaces/IReaderTrackingService.cs
Processing (21/115): src/MyBlog.Core/Interfaces/ISlugService.cs
Processing (22/115): src/MyBlog.Core/Interfaces/ITelemetryLogRepository.cs
Processing (23/115): src/MyBlog.Core/Interfaces/IUserRepository.cs
Processing (24/115): src/MyBlog.Core/Models/Image.cs
Processing (25/115): src/MyBlog.Core/Models/ImageDimensionCache.cs
Processing (26/115): src/MyBlog.Core/Models/Post.cs
Processing (27/115): src/MyBlog.Core/Models/PostDto.cs
Processing (28/115): src/MyBlog.Core/Models/TelemetryLog.cs
Processing (29/115): src/MyBlog.Core/Models/User.cs
Processing (30/115): src/MyBlog.Core/MyBlog.Core.csproj
Processing (31/115): src/MyBlog.Core/Services/MarkdownService.cs
Processing (32/115): src/MyBlog.Core/Services/SlugService.cs
Processing (33/115): src/MyBlog.E2E/Dockerfile
Processing (34/115): src/MyBlog.E2E/MyBlog.E2E.csproj
Processing (35/115): src/MyBlog.E2E/PlaywrightCollection.cs
Processing (36/115): src/MyBlog.E2E/PlaywrightFixture.cs
Processing (37/115): src/MyBlog.E2E/Tests/AboutPageTests.cs
Processing (38/115): src/MyBlog.E2E/Tests/HomePageTests.cs
Processing (39/115): src/MyBlog.E2E/Tests/LoginPageTests.cs
Processing (40/115): src/MyBlog.E2E/Tests/ThemeSwitcherTests.cs
Processing (41/115): src/MyBlog.Infrastructure/Data/BlogDbContext.cs
Processing (42/115): src/MyBlog.Infrastructure/Data/DatabasePathResolver.cs
Processing (43/115): src/MyBlog.Infrastructure/Data/DatabaseSchemaUpdater.cs
Processing (44/115): src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj
Processing (45/115): src/MyBlog.Infrastructure/Repositories/ImageRepository.cs
Processing (46/115): src/MyBlog.Infrastructure/Repositories/PostRepository.cs
Processing (47/115): src/MyBlog.Infrastructure/Repositories/TelemetryLogRepository.cs
Processing (48/115): src/MyBlog.Infrastructure/Repositories/UserRepository.cs
Processing (49/115): src/MyBlog.Infrastructure/ServiceCollectionExtensions.cs
Processing (50/115): src/MyBlog.Infrastructure/Services/AuthService.cs
Processing (51/115): src/MyBlog.Infrastructure/Services/ImageCacheWarmerService.cs
Processing (52/115): src/MyBlog.Infrastructure/Services/ImageDimensionService.cs
Processing (53/115): src/MyBlog.Infrastructure/Services/PasswordService.cs
Processing (54/115): src/MyBlog.Infrastructure/Services/ReaderTrackingService.cs
Processing (55/115): src/MyBlog.Infrastructure/Services/TelemetryCleanupService.cs
Processing (56/115): src/MyBlog.Infrastructure/Telemetry/DatabaseLogExporter.cs
Processing (57/115): src/MyBlog.Infrastructure/Telemetry/FileLogExporter.cs
Processing (58/115): src/MyBlog.Infrastructure/Telemetry/TelemetryPathResolver.cs
Processing (59/115): src/MyBlog.slnx
Processing (60/115): src/MyBlog.Tests/Integration/AuthServiceLongPasswordTests.cs
Processing (61/115): src/MyBlog.Tests/Integration/AuthServiceTests.cs
Processing (62/115): src/MyBlog.Tests/Integration/PasswordChangeTests.cs
Processing (63/115): src/MyBlog.Tests/Integration/PostRepositoryTests.cs
Processing (64/115): src/MyBlog.Tests/Integration/TelemetryCleanupTests.cs
Processing (65/115): src/MyBlog.Tests/MyBlog.Tests.csproj
Processing (66/115): src/MyBlog.Tests/Unit/LoginRateLimitMiddlewareTests.cs
Processing (67/115): src/MyBlog.Tests/Unit/MarkdownServiceTests.cs
Processing (68/115): src/MyBlog.Tests/Unit/PasswordServiceTests.cs
Processing (69/115): src/MyBlog.Tests/Unit/SlugServiceTests.cs
Processing (70/115): src/MyBlog.Web/appsettings.Development.json
Processing (71/115): src/MyBlog.Web/appsettings.json
Processing (72/115): src/MyBlog.Web/Components/App.razor
Processing (73/115): src/MyBlog.Web/Components/_Imports.razor
Processing (74/115): src/MyBlog.Web/Components/Layout/MainLayout.razor
Processing (75/115): src/MyBlog.Web/Components/Pages/About.razor
Processing (76/115): src/MyBlog.Web/Components/Pages/About.razor.css
Processing (77/115): src/MyBlog.Web/Components/Pages/AccessDenied.razor
Processing (78/115): src/MyBlog.Web/Components/Pages/Admin/ChangePassword.razor
Processing (79/115): src/MyBlog.Web/Components/Pages/Admin/ChangePassword.razor.css
Processing (80/115): src/MyBlog.Web/Components/Pages/Admin/Dashboard.razor
Processing (81/115): src/MyBlog.Web/Components/Pages/Admin/Dashboard.razor.css
Processing (82/115): src/MyBlog.Web/Components/Pages/Admin/ImageManager.razor
Processing (83/115): src/MyBlog.Web/Components/Pages/Admin/ImageManager.razor.css
Processing (84/115): src/MyBlog.Web/Components/Pages/Admin/PostEditor.razor
Processing (85/115): src/MyBlog.Web/Components/Pages/Admin/PostEditor.razor.css
Processing (86/115): src/MyBlog.Web/Components/Pages/Admin/PostList.razor
Processing (87/115): src/MyBlog.Web/Components/Pages/Admin/UserEditor.razor
Processing (88/115): src/MyBlog.Web/Components/Pages/Admin/UserEditor.razor.css
Processing (89/115): src/MyBlog.Web/Components/Pages/Admin/UserList.razor
Processing (90/115): src/MyBlog.Web/Components/Pages/Admin/UserList.razor.css
Processing (91/115): src/MyBlog.Web/Components/Pages/Home.razor
Processing (92/115): src/MyBlog.Web/Components/Pages/Login.razor
Processing (93/115): src/MyBlog.Web/Components/Pages/Login.razor.css
Processing (94/115): src/MyBlog.Web/Components/Pages/PostDetail.razor
Processing (95/115): src/MyBlog.Web/Components/Pages/PostDetail.razor.css
Processing (96/115): src/MyBlog.Web/Components/Routes.razor
Processing (97/115): src/MyBlog.Web/Components/Shared/Footer.razor
Processing (98/115): src/MyBlog.Web/Components/Shared/Footer.razor.css
Processing (99/115): src/MyBlog.Web/Components/Shared/MarkdownRenderer.razor
Processing (100/115): src/MyBlog.Web/Components/Shared/Pagination.razor
Processing (101/115): src/MyBlog.Web/Components/Shared/PostCard.razor
Processing (102/115): src/MyBlog.Web/Components/Shared/PostCard.razor.css
Processing (103/115): src/MyBlog.Web/Components/Shared/ReaderBadge.razor
Processing (104/115): src/MyBlog.Web/Components/Shared/ReaderBadge.razor.css
Processing (105/115): src/MyBlog.Web/Components/Shared/RedirectToLogin.razor
Processing (106/115): src/MyBlog.Web/Components/Shared/ThemeSwitcher.razor
Processing (107/115): src/MyBlog.Web/Components/Shared/ThemeSwitcher.razor.css
Processing (108/115): src/MyBlog.Web/Dockerfile
Processing (109/115): src/MyBlog.Web/Hubs/ReaderHub.cs
Processing (110/115): src/MyBlog.Web/Middleware/LoginRateLimitMiddleware.cs
Processing (111/115): src/MyBlog.Web/MyBlog.Web.csproj
Processing (112/115): src/MyBlog.Web/Program.cs
Processing (113/115): src/MyBlog.Web/Properties/launchSettings.json
Processing (114/115): src/MyBlog.Web/wwwroot/css/site.css
Processing (115/115): src/MyBlog.Web/wwwroot/js/site.js

==============================================
  Export Complete!
==============================================

Output file:    docs/llm/dump.txt
Files exported: 115
Files skipped:  0
Output size:    421.64 KB

File types included:
  • Source code: .cs, .fs, .vb
  • Blazor/Razor: .razor
  • UI/XAML: .axaml, .xaml, .paml
  • Projects: .csproj, .slnx, .sln, .props, .targets
  • Config: .json, .yaml, .yml, .xml, .config
  • Docs: .md, .txt
  • Scripts: .sh, .ps1, .cmd, .bat
  • Web: .css, .scss, .js, .ts
  • Other: .sql, .resx, Dockerfile, etc.


real	0m1.251s
user	0m0.673s
sys	0m0.804s
#!/bin/bash
# =============================================================================
# Run E2E Tests with Podman Compose
# =============================================================================
# This script runs Playwright E2E tests against MyBlog using containers.
# Designed for Fedora with SELinux and Podman.
#
# Usage:
#   ./run-e2e.sh          # Run all E2E tests
#   ./run-e2e.sh --build  # Force rebuild containers
#   ./run-e2e.sh --clean  # Clean up and remove volumes
# =============================================================================

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Parse arguments
BUILD_FLAG=""
CLEAN_FLAG=""

for arg in "$@"; do
    case $arg in
        --build)
            BUILD_FLAG="--build"
            ;;
        --clean)
            CLEAN_FLAG="true"
            ;;
    esac
done

# Clean up if requested
if [ "$CLEAN_FLAG" == "true" ]; then
    log_info "Cleaning up containers and volumes..."
    podman-compose -f docker-compose.e2e.yml down -v --remove-orphans 2>/dev/null || true
    podman system prune -f 2>/dev/null || true
    log_info "Cleanup complete"
    exit 0
fi

# Create test results directory
mkdir -p test-results
# Set SELinux context if on Fedora with SELinux
if command -v chcon &> /dev/null && getenforce 2>/dev/null | grep -q "Enforcing"; then
    log_info "Setting SELinux context for test-results directory..."
    chcon -Rt svirt_sandbox_file_t test-results 2>/dev/null || true
fi

log_info "Starting E2E test environment..."

# Build and start services
log_info "Building containers..."
podman-compose -f docker-compose.e2e.yml build $BUILD_FLAG

log_info "Starting MyBlog web service..."
podman-compose -f docker-compose.e2e.yml up -d myblog-web

# Wait for web service to be healthy
log_info "Waiting for MyBlog to be ready..."
RETRIES=30
until podman exec myblog-web curl -sf http://localhost:5000/ > /dev/null 2>&1; do
    RETRIES=$((RETRIES - 1))
    if [ $RETRIES -eq 0 ]; then
        log_error "MyBlog failed to start within timeout"
        podman-compose -f docker-compose.e2e.yml logs myblog-web
        podman-compose -f docker-compose.e2e.yml down -v
        exit 1
    fi
    echo -n "."
    sleep 2
done
echo ""
log_info "MyBlog is ready!"

# Run E2E tests
log_info "Running E2E tests..."
podman-compose -f docker-compose.e2e.yml up myblog-e2e
E2E_EXIT_CODE=$?

# Capture logs
log_info "Capturing logs..."
podman-compose -f docker-compose.e2e.yml logs myblog-web > test-results/myblog-web.log 2>&1
podman-compose -f docker-compose.e2e.yml logs myblog-e2e > test-results/myblog-e2e.log 2>&1

# Clean up
log_info "Cleaning up..."
podman-compose -f docker-compose.e2e.yml down -v

if [ $E2E_EXIT_CODE -eq 0 ]; then
    log_info "E2E tests passed! ✓"
else
    log_error "E2E tests failed with exit code $E2E_EXIT_CODE"
    log_info "Check test-results/ directory for logs"
fi

exit $E2E_EXIT_CODE
[INFO] Cleaning up containers and volumes...
Deleted Images
227e51c85d64fb9fe4d80b70fbcdd0126eb244b66d487d666d15f3adabd06e48
75fd97ce706f3a7989153f76059963366003adc6430796e8884bd9296d9400a5
7c522a98e04643854b5658b5437d3e5ef373ba4d5c9c8b0be2e337bf80822634
e2da78ebdef1d285ecfb23904306aa09cda04daed781d4b77fd0f07ac20e3c1e
7b5059b364e8297776da91a292c813c43c17d3cef00fcf97703b4a551fb794ea
064d449bddde809e514e76ab3f446581eff88871e2812ad1343ec9ccd0242ef4
2381d55153e5b2467371c3c93f95d1aae094cb2b74db5d8b71e88aff7b4a5e0d
498e16187e6341cf5d419a509a160616bc5fe86120e31a67946638adc68a831d
1d5aaf497db0c931fe868ca1274053c0cedc1c1dbd724dd5064ed4a40ecfb5b9
e22430ffb9c5ce8c3ebcc2ba28dfd7b6103ac2254e4f3419629f5874b1d7af67
1dc457df880c2f6e7217dcb21a8c63bd0890a83eaa3a96c0723463ebb2877765
f37fb5c7aa90d66a1035dc3fc8c5c30fbac89cb1cbcce515345070a0bfc1be66
d7c65c2f3c34a35e8963950317c78291525447bff5ee18e03bc8f1a972935d45
9088fc5dedbd2387c4c92d2d01cc6a1afbe05edcb12634893adb90fdba101f64
d18adc53a485057b3f2954d67d2b0e1d8487b67016b3527fd68bf955c3ea084f
67e7e2d4d848fa1a1cdc3f66b0cd67ab03a0568ca34ee5a223f4b5b055046ef9
477269a02ac42fc5d5a2a274a0bc8a65eab4650a87c779d86f29407c008e6acf
019523db4e8258108ed87e3f8a1767a0288a97dddb6be8121b7a1885f6d5407a
9620bc9993482327086f5efcbbcc5b720befc82ad4ed03d3d7bcd3a5ff6319a6
868bbb89063a0f8916ba058e22ee38c88c43dbfacc835aebf690360800c79318
d84170d465ab77bfe02124ce32e38c2eabf88e701247aaa749bde0037cd92b21
5454e63e26e04cd0b9c800b55bfe35030bc22b3e5b94ca2551bd5544adace332
d3cd437cd9469e826a7fb72080fb3e83e928d18565596831e2ebc43221d5548b
f46592264490bfad352ca09e279cc226bd177b5f06d52f1cc43db564daf06a1b
a9171aba0d8432ed1f9b08105aded2d3792e4e347eab79b32d2931ae7ebeae17
Total reclaimed space: 38.47GB
[INFO] Cleanup complete

real	0m1.090s
user	0m0.555s
sys	0m0.567s
[INFO] Setting SELinux context for test-results directory...
[INFO] Starting E2E test environment...
[INFO] Building containers...
STEP 1/18: FROM mcr.microsoft.com/dotnet/sdk:10.0-noble
[1/2] STEP 1/12: FROM mcr.microsoft.com/dotnet/sdk:10.0 AS build
STEP 2/18: WORKDIR /src
--> Using cache 1a780d16107a5473ff68e88b71349c8f166e0a15db185a4d39d77990dcac7ba6
--> 1a780d16107a
STEP 3/18: RUN apt-get update &&     apt-get install -y --no-install-recommends     wget     curl     gnupg     ca-certificates     fonts-liberation     libasound2t64     libatk-bridge2.0-0     libatk1.0-0     libatspi2.0-0     libcairo2     libcups2     libdbus-1-3     libdrm2     libgbm1     libglib2.0-0     libgtk-3-0     libnspr4     libnss3     libpango-1.0-0     libx11-6     libxcb1     libxcomposite1     libxdamage1     libxext6     libxfixes3     libxkbcommon0     libxrandr2     xdg-utils     && rm -rf /var/lib/apt/lists/*
--> Using cache 35dd6a4680b2e84a470a64e7bc1012964c4b139742311026d816ea3cf297c777
--> 35dd6a4680b2
STEP 4/18: RUN wget -q https://packages.microsoft.com/config/ubuntu/24.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb &&     dpkg -i packages-microsoft-prod.deb &&     rm packages-microsoft-prod.deb &&     apt-get update &&     apt-get install -y --no-install-recommends powershell &&     rm -rf /var/lib/apt/lists/*
--> Using cache 9f435cb0092a6e44d88dc2369863fb839a203b7c97f9f70dfc0aad8bd630a111
--> 9f435cb0092a
STEP 5/18: COPY Directory.Build.props .
--> Using cache d2ca33dfcd77dbd49a8a7c64af9d12933c2a10d8c945f0b7f20a464ad989eda8
--> d2ca33dfcd77
STEP 6/18: COPY Directory.Packages.props .
--> Using cache 5410d5936386382118681074c2fee859a37a40abf43236883bc6a99d06caa3d2
--> 5410d5936386
STEP 7/18: COPY MyBlog.Core/MyBlog.Core.csproj MyBlog.Core/
[1/2] STEP 2/12: WORKDIR /src
--> Using cache 3e796636dcd44934c1aea2efc8fa3083034df9dacb1437f111809dc86ae58224
--> 3e796636dcd4
STEP 8/18: COPY MyBlog.Infrastructure/MyBlog.Infrastructure.csproj MyBlog.Infrastructure/
--> 6f9961adf304
[1/2] STEP 3/12: COPY Directory.Build.props .
--> Using cache afc5f754a25bba925873b74f9a59fc474a26c20e4c55a5d27faa4d7fafe800bc
--> afc5f754a25b
STEP 9/18: COPY MyBlog.Web/MyBlog.Web.csproj MyBlog.Web/
--> 145192d4ae9c
[1/2] STEP 4/12: COPY Directory.Packages.props .
--> Using cache c127eb96fadfe7700443760448c86dd771911eeb8f026d0ed2f641d04e516ed6
--> c127eb96fadf
STEP 10/18: COPY MyBlog.E2E/MyBlog.E2E.csproj MyBlog.E2E/
--> Using cache fa8071ffb092e2330b1dce46252ddc3b98d13e027c99b23865952bf67cffae32
--> fa8071ffb092
STEP 11/18: RUN dotnet restore MyBlog.Core/MyBlog.Core.csproj &&     dotnet restore MyBlog.Infrastructure/MyBlog.Infrastructure.csproj &&     dotnet restore MyBlog.Web/MyBlog.Web.csproj &&     dotnet restore MyBlog.E2E/MyBlog.E2E.csproj
--> Using cache 24f5bd25ac8947b04485371a978ee117590869a81dd3c22a2baf665a9c47dcd6
--> 24f5bd25ac89
STEP 12/18: COPY . .
--> 6ce1b9e5fa5a
[1/2] STEP 5/12: COPY MyBlog.Core/MyBlog.Core.csproj MyBlog.Core/
--> bfbd4214af7e
[1/2] STEP 6/12: COPY MyBlog.Infrastructure/MyBlog.Infrastructure.csproj MyBlog.Infrastructure/
--> b06df6a91199
[1/2] STEP 7/12: COPY MyBlog.Web/MyBlog.Web.csproj MyBlog.Web/
--> efbeb69a3e0d
[1/2] STEP 8/12: RUN dotnet restore MyBlog.Web/MyBlog.Web.csproj
  Determining projects to restore...
--> c383e093e775
STEP 13/18: RUN dotnet build MyBlog.E2E/MyBlog.E2E.csproj -c Release
  Determining projects to restore...
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 1.64 sec).
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 2.17 sec).
  Restored /src/MyBlog.E2E/MyBlog.E2E.csproj (in 378 ms).
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 363 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 365 ms).
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 561 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 2.8 sec).
--> 295c5c2ef0b3
[1/2] STEP 9/12: COPY MyBlog.Core/ MyBlog.Core/
--> fd8bc667540e
[1/2] STEP 10/12: COPY MyBlog.Infrastructure/ MyBlog.Infrastructure/
--> 14609c7afc55
[1/2] STEP 11/12: COPY MyBlog.Web/ MyBlog.Web/
--> 1c2f66415789
[1/2] STEP 12/12: RUN dotnet publish MyBlog.Web/MyBlog.Web.csproj -c Release -o /app/publish
  Determining projects to restore...
  MyBlog.Core -> /src/MyBlog.Core/bin/Release/net10.0/MyBlog.Core.dll
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 199 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 201 ms).
  MyBlog.Infrastructure -> /src/MyBlog.Infrastructure/bin/Release/net10.0/MyBlog.Infrastructure.dll
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 609 ms).
  MyBlog.Web -> /src/MyBlog.Web/bin/Release/net10.0/MyBlog.Web.dll
  MyBlog.E2E -> /src/MyBlog.E2E/bin/Release/net10.0/MyBlog.E2E.dll

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:08.36
  MyBlog.Core -> /src/MyBlog.Core/bin/Release/net10.0/MyBlog.Core.dll
  MyBlog.Infrastructure -> /src/MyBlog.Infrastructure/bin/Release/net10.0/MyBlog.Infrastructure.dll
--> 77ce29f2e6bb
STEP 14/18: RUN pwsh ./MyBlog.E2E/bin/Release/net10.0/playwright.ps1 install chromium
Downloading Chromium 143.0.7499.4 (playwright build v1200) from https://cdn.playwright.dev/dbazure/download/playwright/builds/chromium/1200/chromium-linux.zip
(node:34) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 164.7 MiB
|■■■■■■■■                                                                        |  10% of 164.7 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 164.7 MiB
  MyBlog.Web -> /src/MyBlog.Web/bin/Release/net10.0/MyBlog.Web.dll
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 164.7 MiB
  MyBlog.Web -> /app/publish/
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 164.7 MiB
--> 6671d7db50d6
[2/2] STEP 1/12: FROM mcr.microsoft.com/dotnet/aspnet:10.0 AS runtime
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 164.7 MiB
[2/2] STEP 2/12: WORKDIR /app
--> Using cache 7ab200e45b1fba59b74177866b30af0761e035beacbc6a5d1607edc1b649f36a
--> 7ab200e45b1f
[2/2] STEP 3/12: RUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/*
--> Using cache 1e21b972573d10c4ea9d7b8076e58aed09bb9967e8ee6d5a8c3c77e2cddd1001
--> 1e21b972573d
[2/2] STEP 4/12: RUN useradd -m -s /bin/bash appuser
--> Using cache 7b0ba419cc37495396a1969cd185514b97ee464988ce4bddc954893f0ac664d5
--> 7b0ba419cc37
[2/2] STEP 5/12: RUN mkdir -p /app/data && chown appuser:appuser /app/data
--> Using cache 1a52159880ea26e77195a71342eb88df7e9cb2112f4b48a28ce51dfc69734231
--> 1a52159880ea
[2/2] STEP 6/12: COPY --from=build /app/publish .
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 164.7 MiB
--> ba2ffaed226d
[2/2] STEP 7/12: ENV ASPNETCORE_URLS=http://+:5000
--> 7843ad79b72f
[2/2] STEP 8/12: ENV ASPNETCORE_ENVIRONMENT=Production
--> ed556a95d1d6
[2/2] STEP 9/12: ENV ConnectionStrings__DefaultConnection="Data Source=/app/data/myblog.db"
--> 896c4957ef00
[2/2] STEP 10/12: USER appuser
--> 468603877da2
[2/2] STEP 11/12: EXPOSE 5000
--> ca32d91a9738
[2/2] STEP 12/12: ENTRYPOINT ["dotnet", "MyBlog.Web.dll"]
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 164.7 MiB
[2/2] COMMIT myblog_myblog-web
--> 30df7acb465d
Successfully tagged localhost/myblog_myblog-web:latest
30df7acb465d431d252a196a314095e896b0c6560637f6d3dfd0808c2bc69820
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 164.7 MiB
Chromium 143.0.7499.4 (playwright build v1200) downloaded to /root/.cache/ms-playwright/chromium-1200
Downloading FFMPEG playwright build v1011 from https://cdn.playwright.dev/dbazure/download/playwright/builds/ffmpeg/1011/ffmpeg-linux.zip
(node:45) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 2.3 MiB
|■■■■■■■■                                                                        |  10% of 2.3 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 2.3 MiB
FFMPEG playwright build v1011 downloaded to /root/.cache/ms-playwright/ffmpeg-1011
Downloading Chromium Headless Shell 143.0.7499.4 (playwright build v1200) from https://cdn.playwright.dev/dbazure/download/playwright/builds/chromium/1200/chromium-headless-shell-linux.zip
(node:56) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 109.7 MiB
|■■■■■■■■                                                                        |  10% of 109.7 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 109.7 MiB
Chromium Headless Shell 143.0.7499.4 (playwright build v1200) downloaded to /root/.cache/ms-playwright/chromium_headless_shell-1200
--> af5775e57fb1
STEP 15/18: WORKDIR /src/MyBlog.E2E
--> 02a9000fea02
STEP 16/18: ENV MYBLOG_BASE_URL=http://myblog-web:5000
--> ce13f17245ef
STEP 17/18: ENV PLAYWRIGHT_HEADLESS=true
--> a1ac938c6bcd
STEP 18/18: ENTRYPOINT ["dotnet", "run", "-c", "Release", "--no-build"]
COMMIT myblog_myblog-e2e
--> c77ced734dbb
Successfully tagged localhost/myblog_myblog-e2e:latest
c77ced734dbb6872e88c6ab1129039b0026b92f958b7c304643365f45f7d2e68
[INFO] Starting MyBlog web service...
cfcc94912af7ae222d907136671d0d5f75409917d4b6487a13dad0b0fdf2ee7b
62717e4439527f3177cbe9643e546445992736705fa28fb21a86c05abbd9dd34
myblog-web
[INFO] Waiting for MyBlog to be ready...
.
[INFO] MyBlog is ready!
[INFO] Running E2E tests...
2fc0e64619e5d75e7fcfd01511918f04120121e63573ca60540dd74dfefa48e7
[myblog-web] | cannot open `/run/user/1000/crun/62717e4439527f3177cbe9643e546445992736705fa28fb21a86c05abbd9dd34/exec.fifo`: No such file or directory
[myblog-web] | Error: unable to start container 62717e4439527f3177cbe9643e546445992736705fa28fb21a86c05abbd9dd34: `/usr/bin/crun start 62717e4439527f3177cbe9643e546445992736705fa28fb21a86c05abbd9dd34` failed: exit status 1
[myblog-e2e] | xUnit.net v3 In-Process Runner v3.2.2+728c1dce01 (64-bit .NET 10.0.1)
[myblog-e2e] |   Discovering: MyBlog.E2E
[myblog-e2e] |   Discovered:  MyBlog.E2E
[myblog-e2e] |   Starting:    MyBlog.E2E
[myblog-e2e] |   Finished:    MyBlog.E2E (ID = '4d488734a9156ea8719a93bca3e9cb47dfeac4715a7981582060bf185a1e7bf4')
[myblog-e2e] | === TEST EXECUTION SUMMARY ===
[myblog-e2e] |    MyBlog.E2E  Total: 15, Errors: 0, Failed: 0, Skipped: 0, Not Run: 0, Time: 5.865s
[myblog-e2e] | 
[INFO] Capturing logs...
[INFO] Cleaning up...
myblog-e2e
myblog-web
myblog-e2e
myblog-web
myblog_myblog-data
cfcc94912af7ae222d907136671d0d5f75409917d4b6487a13dad0b0fdf2ee7b
myblog_myblog-network
[INFO] E2E tests passed! ✓

real	0m46.023s
user	0m31.573s
sys	0m17.848s
kushal@fedora:~/src/dotnet/MyBlog$ cd ~/src/dotnet/MyBlog/ && export DOTNET_CLI_TELEMETRY_OPTOUT=1 && (cd src && time dotnet format; time dotnet restore; time dotnet clean; time dotnet build; time dotnet run --project MyBlog.Tests/MyBlog.Tests.csproj; time dotnet list package; time dotnet list package --outdated); cd ~/src/dotnet/MyBlog/ && time bash export.sh; cat run-e2e.sh; time bash run-e2e.sh --clean; time bash run-e2e.sh;

real	0m8.423s
user	0m14.396s
sys	0m1.033s
Restore complete (0.5s)

Build succeeded in 0.6s

real	0m0.722s
user	0m0.791s
sys	0m0.165s

Build succeeded in 0.5s

real	0m0.654s
user	0m0.714s
sys	0m0.200s
Restore complete (0.5s)
  MyBlog.Core net10.0 succeeded (2.9s) → MyBlog.Core/bin/Debug/net10.0/MyBlog.Core.dll
  MyBlog.Infrastructure net10.0 succeeded (0.4s) → MyBlog.Infrastructure/bin/Debug/net10.0/MyBlog.Infrastructure.dll
  MyBlog.Web net10.0 succeeded (2.3s) → MyBlog.Web/bin/Debug/net10.0/MyBlog.Web.dll
  MyBlog.Tests net10.0 succeeded (0.5s) → MyBlog.Tests/bin/Debug/net10.0/MyBlog.Tests.dll
  MyBlog.E2E net10.0 succeeded (0.5s) → MyBlog.E2E/bin/Debug/net10.0/MyBlog.E2E.dll

Build succeeded in 6.8s

real	0m6.969s
user	0m2.504s
sys	0m0.467s
xUnit.net v3 In-Process Runner v3.2.2+728c1dce01 (64-bit .NET 10.0.2)
  Discovering: MyBlog.Tests
  Discovered:  MyBlog.Tests
  Starting:    MyBlog.Tests
  Finished:    MyBlog.Tests (ID = '24cedafe73dab5684218bb3cf04cfd49ae8ce3b87ae799399cb2e301cbc1e755')
=== TEST EXECUTION SUMMARY ===
   MyBlog.Tests  Total: 77, Errors: 0, Failed: 0, Skipped: 0, Not Run: 0, Time: 40.652s

real	0m42.524s
user	0m45.080s
sys	0m0.612s
Restore complete (0.4s)

Build succeeded in 0.5s
Project 'MyBlog.Core' has the following package references
   [net10.0]: 
   Top-level Package                   Requested   Resolved
   > Microsoft.Extensions.Logging      10.0.2      10.0.2  

Project 'MyBlog.E2E' has the following package references
   [net10.0]: 
   Top-level Package             Requested   Resolved
   > Microsoft.NET.Test.Sdk      18.0.1      18.0.1  
   > Microsoft.Playwright        1.57.0      1.57.0  
   > xunit.v3                    3.2.2       3.2.2   

Project 'MyBlog.Infrastructure' has the following package references
   [net10.0]: 
   Top-level Package                           Requested   Resolved
   > Microsoft.AspNetCore.Identity             2.3.9       2.3.9   
   > Microsoft.EntityFrameworkCore.Sqlite      10.0.2      10.0.2  
   > Microsoft.Extensions.Http                 10.0.2      10.0.2  
   > OpenTelemetry                             1.15.0      1.15.0  

Project 'MyBlog.Tests' has the following package references
   [net10.0]: 
   Top-level Package                             Requested   Resolved
   > Microsoft.EntityFrameworkCore.Sqlite        10.0.2      10.0.2  
   > Microsoft.NET.Test.Sdk                      18.0.1      18.0.1  
   > Microsoft.Testing.Extensions.TrxReport      2.0.2       2.0.2   
   > xunit.v3                                    3.2.2       3.2.2   

Project 'MyBlog.Web' has the following package references
   [net10.0]: 
   Top-level Package                                  Requested    Resolved
   > Microsoft.AspNetCore.App.Internal.Assets   (A)   [10.0.2, )   10.0.2  
   > Microsoft.AspNetCore.SignalR.Client              10.0.2       10.0.2  
   > OpenTelemetry.Exporter.Console                   1.15.0       1.15.0  
   > OpenTelemetry.Extensions.Hosting                 1.15.0       1.15.0  
   > OpenTelemetry.Instrumentation.AspNetCore         1.15.0       1.15.0  
   > OpenTelemetry.Instrumentation.Http               1.15.0       1.15.0  

(A) : Auto-referenced package.

real	0m1.470s
user	0m1.492s
sys	0m0.363s
Restore complete (0.4s)

Build succeeded in 0.5s

The following sources were used:
   https://api.nuget.org/v3/index.json

The given project `MyBlog.Core` has no updates given the current sources.
The given project `MyBlog.E2E` has no updates given the current sources.
The given project `MyBlog.Infrastructure` has no updates given the current sources.
The given project `MyBlog.Tests` has no updates given the current sources.
The given project `MyBlog.Web` has no updates given the current sources.

real	0m3.147s
user	0m2.036s
sys	0m0.413s
==============================================
  Project Export for LLM Analysis
==============================================

Project Path: /home/kushal/src/dotnet/MyBlog
Output File:  docs/llm/dump.txt

Generating directory structure...
Collecting files...
Found 115 files to export

Processing (1/115): docker-compose.e2e.yml
Processing (2/115): docker-compose.yml
Processing (3/115): .editorconfig
Processing (4/115): export.sh
Processing (5/115): .github/workflows/build-deploy.yml
Processing (6/115): .gitignore
Processing (7/115): README.md
Processing (8/115): run-e2e.sh
Processing (9/115): src/Directory.Build.props
Processing (10/115): src/Directory.Packages.props
Processing (11/115): src/.github/workflows/build-deploy.yml
Processing (12/115): src/global.json
Processing (13/115): src/MyBlog.Core/Constants/AppConstants.cs
Processing (14/115): src/MyBlog.Core/Interfaces/IAuthService.cs
Processing (15/115): src/MyBlog.Core/Interfaces/IImageDimensionService.cs
Processing (16/115): src/MyBlog.Core/Interfaces/IImageRepository.cs
Processing (17/115): src/MyBlog.Core/Interfaces/IMarkdownService.cs
Processing (18/115): src/MyBlog.Core/Interfaces/IPasswordService.cs
Processing (19/115): src/MyBlog.Core/Interfaces/IPostRepository.cs
Processing (20/115): src/MyBlog.Core/Interfaces/IReaderTrackingService.cs
Processing (21/115): src/MyBlog.Core/Interfaces/ISlugService.cs
Processing (22/115): src/MyBlog.Core/Interfaces/ITelemetryLogRepository.cs
Processing (23/115): src/MyBlog.Core/Interfaces/IUserRepository.cs
Processing (24/115): src/MyBlog.Core/Models/Image.cs
Processing (25/115): src/MyBlog.Core/Models/ImageDimensionCache.cs
Processing (26/115): src/MyBlog.Core/Models/Post.cs
Processing (27/115): src/MyBlog.Core/Models/PostDto.cs
Processing (28/115): src/MyBlog.Core/Models/TelemetryLog.cs
Processing (29/115): src/MyBlog.Core/Models/User.cs
Processing (30/115): src/MyBlog.Core/MyBlog.Core.csproj
Processing (31/115): src/MyBlog.Core/Services/MarkdownService.cs
Processing (32/115): src/MyBlog.Core/Services/SlugService.cs
Processing (33/115): src/MyBlog.E2E/Dockerfile
Processing (34/115): src/MyBlog.E2E/MyBlog.E2E.csproj
Processing (35/115): src/MyBlog.E2E/PlaywrightCollection.cs
Processing (36/115): src/MyBlog.E2E/PlaywrightFixture.cs
Processing (37/115): src/MyBlog.E2E/Tests/AboutPageTests.cs
Processing (38/115): src/MyBlog.E2E/Tests/HomePageTests.cs
Processing (39/115): src/MyBlog.E2E/Tests/LoginPageTests.cs
Processing (40/115): src/MyBlog.E2E/Tests/ThemeSwitcherTests.cs
Processing (41/115): src/MyBlog.Infrastructure/Data/BlogDbContext.cs
Processing (42/115): src/MyBlog.Infrastructure/Data/DatabasePathResolver.cs
Processing (43/115): src/MyBlog.Infrastructure/Data/DatabaseSchemaUpdater.cs
Processing (44/115): src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj
Processing (45/115): src/MyBlog.Infrastructure/Repositories/ImageRepository.cs
Processing (46/115): src/MyBlog.Infrastructure/Repositories/PostRepository.cs
Processing (47/115): src/MyBlog.Infrastructure/Repositories/TelemetryLogRepository.cs
Processing (48/115): src/MyBlog.Infrastructure/Repositories/UserRepository.cs
Processing (49/115): src/MyBlog.Infrastructure/ServiceCollectionExtensions.cs
Processing (50/115): src/MyBlog.Infrastructure/Services/AuthService.cs
Processing (51/115): src/MyBlog.Infrastructure/Services/ImageCacheWarmerService.cs
Processing (52/115): src/MyBlog.Infrastructure/Services/ImageDimensionService.cs
Processing (53/115): src/MyBlog.Infrastructure/Services/PasswordService.cs
Processing (54/115): src/MyBlog.Infrastructure/Services/ReaderTrackingService.cs
Processing (55/115): src/MyBlog.Infrastructure/Services/TelemetryCleanupService.cs
Processing (56/115): src/MyBlog.Infrastructure/Telemetry/DatabaseLogExporter.cs
Processing (57/115): src/MyBlog.Infrastructure/Telemetry/FileLogExporter.cs
Processing (58/115): src/MyBlog.Infrastructure/Telemetry/TelemetryPathResolver.cs
Processing (59/115): src/MyBlog.slnx
Processing (60/115): src/MyBlog.Tests/Integration/AuthServiceLongPasswordTests.cs
Processing (61/115): src/MyBlog.Tests/Integration/AuthServiceTests.cs
Processing (62/115): src/MyBlog.Tests/Integration/PasswordChangeTests.cs
Processing (63/115): src/MyBlog.Tests/Integration/PostRepositoryTests.cs
Processing (64/115): src/MyBlog.Tests/Integration/TelemetryCleanupTests.cs
Processing (65/115): src/MyBlog.Tests/MyBlog.Tests.csproj
Processing (66/115): src/MyBlog.Tests/Unit/LoginRateLimitMiddlewareTests.cs
Processing (67/115): src/MyBlog.Tests/Unit/MarkdownServiceTests.cs
Processing (68/115): src/MyBlog.Tests/Unit/PasswordServiceTests.cs
Processing (69/115): src/MyBlog.Tests/Unit/SlugServiceTests.cs
Processing (70/115): src/MyBlog.Web/appsettings.Development.json
Processing (71/115): src/MyBlog.Web/appsettings.json
Processing (72/115): src/MyBlog.Web/Components/App.razor
Processing (73/115): src/MyBlog.Web/Components/_Imports.razor
Processing (74/115): src/MyBlog.Web/Components/Layout/MainLayout.razor
Processing (75/115): src/MyBlog.Web/Components/Pages/About.razor
Processing (76/115): src/MyBlog.Web/Components/Pages/About.razor.css
Processing (77/115): src/MyBlog.Web/Components/Pages/AccessDenied.razor
Processing (78/115): src/MyBlog.Web/Components/Pages/Admin/ChangePassword.razor
Processing (79/115): src/MyBlog.Web/Components/Pages/Admin/ChangePassword.razor.css
Processing (80/115): src/MyBlog.Web/Components/Pages/Admin/Dashboard.razor
Processing (81/115): src/MyBlog.Web/Components/Pages/Admin/Dashboard.razor.css
Processing (82/115): src/MyBlog.Web/Components/Pages/Admin/ImageManager.razor
Processing (83/115): src/MyBlog.Web/Components/Pages/Admin/ImageManager.razor.css
Processing (84/115): src/MyBlog.Web/Components/Pages/Admin/PostEditor.razor
Processing (85/115): src/MyBlog.Web/Components/Pages/Admin/PostEditor.razor.css
Processing (86/115): src/MyBlog.Web/Components/Pages/Admin/PostList.razor
Processing (87/115): src/MyBlog.Web/Components/Pages/Admin/UserEditor.razor
Processing (88/115): src/MyBlog.Web/Components/Pages/Admin/UserEditor.razor.css
Processing (89/115): src/MyBlog.Web/Components/Pages/Admin/UserList.razor
Processing (90/115): src/MyBlog.Web/Components/Pages/Admin/UserList.razor.css
Processing (91/115): src/MyBlog.Web/Components/Pages/Home.razor
Processing (92/115): src/MyBlog.Web/Components/Pages/Login.razor
Processing (93/115): src/MyBlog.Web/Components/Pages/Login.razor.css
Processing (94/115): src/MyBlog.Web/Components/Pages/PostDetail.razor
Processing (95/115): src/MyBlog.Web/Components/Pages/PostDetail.razor.css
Processing (96/115): src/MyBlog.Web/Components/Routes.razor
Processing (97/115): src/MyBlog.Web/Components/Shared/Footer.razor
Processing (98/115): src/MyBlog.Web/Components/Shared/Footer.razor.css
Processing (99/115): src/MyBlog.Web/Components/Shared/MarkdownRenderer.razor
Processing (100/115): src/MyBlog.Web/Components/Shared/Pagination.razor
Processing (101/115): src/MyBlog.Web/Components/Shared/PostCard.razor
Processing (102/115): src/MyBlog.Web/Components/Shared/PostCard.razor.css
Processing (103/115): src/MyBlog.Web/Components/Shared/ReaderBadge.razor
Processing (104/115): src/MyBlog.Web/Components/Shared/ReaderBadge.razor.css
Processing (105/115): src/MyBlog.Web/Components/Shared/RedirectToLogin.razor
Processing (106/115): src/MyBlog.Web/Components/Shared/ThemeSwitcher.razor
Processing (107/115): src/MyBlog.Web/Components/Shared/ThemeSwitcher.razor.css
Processing (108/115): src/MyBlog.Web/Dockerfile
Processing (109/115): src/MyBlog.Web/Hubs/ReaderHub.cs
Processing (110/115): src/MyBlog.Web/Middleware/LoginRateLimitMiddleware.cs
Processing (111/115): src/MyBlog.Web/MyBlog.Web.csproj
Processing (112/115): src/MyBlog.Web/Program.cs
Processing (113/115): src/MyBlog.Web/Properties/launchSettings.json
Processing (114/115): src/MyBlog.Web/wwwroot/css/site.css
Processing (115/115): src/MyBlog.Web/wwwroot/js/site.js

==============================================
  Export Complete!
==============================================

Output file:    docs/llm/dump.txt
Files exported: 115
Files skipped:  0
Output size:    421.75 KB

File types included:
  • Source code: .cs, .fs, .vb
  • Blazor/Razor: .razor
  • UI/XAML: .axaml, .xaml, .paml
  • Projects: .csproj, .slnx, .sln, .props, .targets
  • Config: .json, .yaml, .yml, .xml, .config
  • Docs: .md, .txt
  • Scripts: .sh, .ps1, .cmd, .bat
  • Web: .css, .scss, .js, .ts
  • Other: .sql, .resx, Dockerfile, etc.


real	0m1.097s
user	0m0.681s
sys	0m0.655s
#!/bin/bash
# =============================================================================
# Run E2E Tests with Podman Compose
# =============================================================================
# This script runs Playwright E2E tests against MyBlog using containers.
# Designed for Fedora with SELinux and Podman.
#
# Usage:
#   ./run-e2e.sh          # Run all E2E tests
#   ./run-e2e.sh --build  # Force rebuild containers
#   ./run-e2e.sh --clean  # Clean up and remove volumes
# =============================================================================

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Parse arguments
BUILD_FLAG=""
CLEAN_FLAG=""

for arg in "$@"; do
    case $arg in
        --build)
            BUILD_FLAG="--build"
            ;;
        --clean)
            CLEAN_FLAG="true"
            ;;
    esac
done

# Clean up if requested
if [ "$CLEAN_FLAG" == "true" ]; then
    log_info "Cleaning up containers and volumes..."
    podman-compose -f docker-compose.e2e.yml down -v --remove-orphans 2>/dev/null || true
    podman system prune -f 2>/dev/null || true
    log_info "Cleanup complete"
    exit 0
fi

# Create test results directory
mkdir -p test-results
# Set SELinux context if on Fedora with SELinux
if command -v chcon &> /dev/null && getenforce 2>/dev/null | grep -q "Enforcing"; then
    log_info "Setting SELinux context for test-results directory..."
    chcon -Rt svirt_sandbox_file_t test-results 2>/dev/null || true
fi

log_info "Starting E2E test environment..."

# Build and start services
log_info "Building containers..."
podman-compose -f docker-compose.e2e.yml build $BUILD_FLAG

log_info "Starting MyBlog web service..."
podman-compose -f docker-compose.e2e.yml up -d myblog-web

# Wait for web service to be healthy
log_info "Waiting for MyBlog to be ready..."
RETRIES=30
until podman exec myblog-web curl -sf http://localhost:5000/ > /dev/null 2>&1; do
    RETRIES=$((RETRIES - 1))
    if [ $RETRIES -eq 0 ]; then
        log_error "MyBlog failed to start within timeout"
        podman-compose -f docker-compose.e2e.yml logs myblog-web
        podman-compose -f docker-compose.e2e.yml down -v
        exit 1
    fi
    echo -n "."
    sleep 2
done
echo ""
log_info "MyBlog is ready!"

# Run E2E tests
log_info "Running E2E tests..."
podman-compose -f docker-compose.e2e.yml up myblog-e2e
E2E_EXIT_CODE=$?

# Capture logs
log_info "Capturing logs..."
podman-compose -f docker-compose.e2e.yml logs myblog-web > test-results/myblog-web.log 2>&1
podman-compose -f docker-compose.e2e.yml logs myblog-e2e > test-results/myblog-e2e.log 2>&1

# Clean up
log_info "Cleaning up..."
podman-compose -f docker-compose.e2e.yml down -v

if [ $E2E_EXIT_CODE -eq 0 ]; then
    log_info "E2E tests passed! ✓"
else
    log_error "E2E tests failed with exit code $E2E_EXIT_CODE"
    log_info "Check test-results/ directory for logs"
fi

exit $E2E_EXIT_CODE
[INFO] Cleaning up containers and volumes...
Deleted Images
b613842eb8bf513140edc9f4584545d704ca59b338b07ae8922ed7827c2cde2c
1b0766ea54448a7f81a35666cde3ef61fcfba0158c0688389a3e1e0ee73ab431
b5fd16d65b5dbfa32d6075cfac22db81b17de93e3b8c7b414f6c10b685b774f4
6cae48669a8021d60adb7207844545979ffc14a62bc39b8346a0b4daf485b561
a3b36be20c3575d66e861c6a21671daaafa20c3c1879ffb3207d8bd495c4d229
b148c3c634f5d61aae783e83711126449f546efcff86180a6ead0e8033ef3b7d
867ba62e6a9b7aa36ad143aaa107c183540d5b1c4eeb212747c3f8403027d42d
6225156a57f61da1e0804beac9e1ea2c67a841aee4c79a0a5b135073e2704062
3a1509435d97ace509de369a7e91c3d95885c88d81f50b3f0d9284c84ae669a5
3c13a6c74ce67abf422824df6e3004bfbbf58e93d8850ca69d6e3e122c3b906d
0b21d39db2213577f9a2ff69933b4ad2737e62805c4e195da28f10e06c95d898
b31c68f14cdbacff422e3dce140ce82800745c85db59c1a9f03485cc9a22ba93
ce6c30cfd239b9323f8cd1caad0de3791cc97f9ad4ff56a40871fc6e3cbe5eef
aea107e44d125fefa61efd41a405b71c31c7fc3bfee28d814f8b65c5eb4d0f80
6671d7db50d67156534460f17352159f4320e376c1017758b29f82ab70a51f53
1c2f66415789723a4852b3efe8fe07c5745d24bb7305762ed42b236d902e6478
14609c7afc5573e5c75bb248d392011175fcb9c5a3f17b51480e2e0999ca6a7d
fd8bc667540ee1de19f4b677a4d61ad62fb4bb4388475229de0bcbcb5837b459
295c5c2ef0b37c9da829ba0c3700805d1cdcdc910202df9b1155ac4a1feec480
efbeb69a3e0d9de706ccafd60078e50268f479b3d3c224a477bdc3eee57cd14f
b06df6a91199f9ec6f6f0e9121bd8ba0e2f09056e742de52941e566e8e10d73e
bfbd4214af7ed52d63d75fb732a3ecd5522fc5f493425449da8d37b3009237d3
6ce1b9e5fa5afc2bfde0a471b95f561ab744d7b9e985b23a489e41bf27609801
145192d4ae9c0b53c701b9b780ca8ef60ae96f870223b833f499468d57982f8a
6f9961adf30470cb33ba83874ff4fea1ca17e126d13b789370c2b9f04aed397e
Total reclaimed space: 38.47GB
[INFO] Cleanup complete

real	0m0.881s
user	0m0.476s
sys	0m0.494s
[INFO] Setting SELinux context for test-results directory...
[INFO] Starting E2E test environment...
[INFO] Building containers...
[1/2] STEP 1/12: FROM mcr.microsoft.com/dotnet/sdk:10.0 AS build
STEP 1/18: FROM mcr.microsoft.com/dotnet/sdk:10.0-noble
STEP 2/18: WORKDIR /src
--> Using cache 1a780d16107a5473ff68e88b71349c8f166e0a15db185a4d39d77990dcac7ba6
--> 1a780d16107a
STEP 3/18: RUN apt-get update &&     apt-get install -y --no-install-recommends     wget     curl     gnupg     ca-certificates     fonts-liberation     libasound2t64     libatk-bridge2.0-0     libatk1.0-0     libatspi2.0-0     libcairo2     libcups2     libdbus-1-3     libdrm2     libgbm1     libglib2.0-0     libgtk-3-0     libnspr4     libnss3     libpango-1.0-0     libx11-6     libxcb1     libxcomposite1     libxdamage1     libxext6     libxfixes3     libxkbcommon0     libxrandr2     xdg-utils     && rm -rf /var/lib/apt/lists/*
--> Using cache 35dd6a4680b2e84a470a64e7bc1012964c4b139742311026d816ea3cf297c777
--> 35dd6a4680b2
STEP 4/18: RUN wget -q https://packages.microsoft.com/config/ubuntu/24.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb &&     dpkg -i packages-microsoft-prod.deb &&     rm packages-microsoft-prod.deb &&     apt-get update &&     apt-get install -y --no-install-recommends powershell &&     rm -rf /var/lib/apt/lists/*
--> Using cache 9f435cb0092a6e44d88dc2369863fb839a203b7c97f9f70dfc0aad8bd630a111
--> 9f435cb0092a
STEP 5/18: COPY Directory.Build.props .
--> Using cache d2ca33dfcd77dbd49a8a7c64af9d12933c2a10d8c945f0b7f20a464ad989eda8
--> d2ca33dfcd77
STEP 6/18: COPY Directory.Packages.props .
--> Using cache 5410d5936386382118681074c2fee859a37a40abf43236883bc6a99d06caa3d2
--> 5410d5936386
STEP 7/18: COPY MyBlog.Core/MyBlog.Core.csproj MyBlog.Core/
[1/2] STEP 2/12: WORKDIR /src
--> 427b9e3cd311
--> Using cache 3e796636dcd44934c1aea2efc8fa3083034df9dacb1437f111809dc86ae58224
--> 3e796636dcd4
[1/2] STEP 3/12: COPY Directory.Build.props .
STEP 8/18: COPY MyBlog.Infrastructure/MyBlog.Infrastructure.csproj MyBlog.Infrastructure/
--> Using cache afc5f754a25bba925873b74f9a59fc474a26c20e4c55a5d27faa4d7fafe800bc
--> afc5f754a25b
STEP 9/18: COPY MyBlog.Web/MyBlog.Web.csproj MyBlog.Web/
--> 2f6938ba3e22
[1/2] STEP 4/12: COPY Directory.Packages.props .
--> Using cache c127eb96fadfe7700443760448c86dd771911eeb8f026d0ed2f641d04e516ed6
--> c127eb96fadf
STEP 10/18: COPY MyBlog.E2E/MyBlog.E2E.csproj MyBlog.E2E/
--> 958758360b27
[1/2] STEP 5/12: COPY MyBlog.Core/MyBlog.Core.csproj MyBlog.Core/
--> Using cache fa8071ffb092e2330b1dce46252ddc3b98d13e027c99b23865952bf67cffae32
--> fa8071ffb092
STEP 11/18: RUN dotnet restore MyBlog.Core/MyBlog.Core.csproj &&     dotnet restore MyBlog.Infrastructure/MyBlog.Infrastructure.csproj &&     dotnet restore MyBlog.Web/MyBlog.Web.csproj &&     dotnet restore MyBlog.E2E/MyBlog.E2E.csproj
--> Using cache 24f5bd25ac8947b04485371a978ee117590869a81dd3c22a2baf665a9c47dcd6
--> 24f5bd25ac89
STEP 12/18: COPY . .
--> 93eba9c02f67
[1/2] STEP 6/12: COPY MyBlog.Infrastructure/MyBlog.Infrastructure.csproj MyBlog.Infrastructure/
--> a2d011e01242
[1/2] STEP 7/12: COPY MyBlog.Web/MyBlog.Web.csproj MyBlog.Web/
--> 24cfea460c5b
[1/2] STEP 8/12: RUN dotnet restore MyBlog.Web/MyBlog.Web.csproj
  Determining projects to restore...
--> 3878cfb2af53
STEP 13/18: RUN dotnet build MyBlog.E2E/MyBlog.E2E.csproj -c Release
  Determining projects to restore...
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 2.23 sec).
  Restored /src/MyBlog.E2E/MyBlog.E2E.csproj (in 473 ms).
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 464 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 465 ms).
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 2.78 sec).
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 825 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 3.32 sec).
--> 846790beeb89
[1/2] STEP 9/12: COPY MyBlog.Core/ MyBlog.Core/
--> 703bc1660c12
[1/2] STEP 10/12: COPY MyBlog.Infrastructure/ MyBlog.Infrastructure/
--> 0f6c2aa1129f
[1/2] STEP 11/12: COPY MyBlog.Web/ MyBlog.Web/
--> c9280f8bed2b
[1/2] STEP 12/12: RUN dotnet publish MyBlog.Web/MyBlog.Web.csproj -c Release -o /app/publish
  MyBlog.Core -> /src/MyBlog.Core/bin/Release/net10.0/MyBlog.Core.dll
  Determining projects to restore...
  MyBlog.Infrastructure -> /src/MyBlog.Infrastructure/bin/Release/net10.0/MyBlog.Infrastructure.dll
  Restored /src/MyBlog.Core/MyBlog.Core.csproj (in 164 ms).
  Restored /src/MyBlog.Infrastructure/MyBlog.Infrastructure.csproj (in 170 ms).
  Restored /src/MyBlog.Web/MyBlog.Web.csproj (in 501 ms).
  MyBlog.Web -> /src/MyBlog.Web/bin/Release/net10.0/MyBlog.Web.dll
  MyBlog.E2E -> /src/MyBlog.E2E/bin/Release/net10.0/MyBlog.E2E.dll

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:08.05
  MyBlog.Core -> /src/MyBlog.Core/bin/Release/net10.0/MyBlog.Core.dll
  MyBlog.Infrastructure -> /src/MyBlog.Infrastructure/bin/Release/net10.0/MyBlog.Infrastructure.dll
--> 680f7728a075
STEP 14/18: RUN pwsh ./MyBlog.E2E/bin/Release/net10.0/playwright.ps1 install chromium
Downloading Chromium 143.0.7499.4 (playwright build v1200) from https://cdn.playwright.dev/dbazure/download/playwright/builds/chromium/1200/chromium-linux.zip
(node:34) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 164.7 MiB
|■■■■■■■■                                                                        |  10% of 164.7 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 164.7 MiB
  MyBlog.Web -> /src/MyBlog.Web/bin/Release/net10.0/MyBlog.Web.dll
  MyBlog.Web -> /app/publish/
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 164.7 MiB
--> c00fb814b225
[2/2] STEP 1/12: FROM mcr.microsoft.com/dotnet/aspnet:10.0 AS runtime
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 164.7 MiB
[2/2] STEP 2/12: WORKDIR /app
--> Using cache 7ab200e45b1fba59b74177866b30af0761e035beacbc6a5d1607edc1b649f36a
--> 7ab200e45b1f
[2/2] STEP 3/12: RUN apt-get update && apt-get install -y --no-install-recommends curl && rm -rf /var/lib/apt/lists/*
--> Using cache 1e21b972573d10c4ea9d7b8076e58aed09bb9967e8ee6d5a8c3c77e2cddd1001
--> 1e21b972573d
[2/2] STEP 4/12: RUN useradd -m -s /bin/bash appuser
--> Using cache 7b0ba419cc37495396a1969cd185514b97ee464988ce4bddc954893f0ac664d5
--> 7b0ba419cc37
[2/2] STEP 5/12: RUN mkdir -p /app/data && chown appuser:appuser /app/data
--> Using cache 1a52159880ea26e77195a71342eb88df7e9cb2112f4b48a28ce51dfc69734231
--> 1a52159880ea
[2/2] STEP 6/12: COPY --from=build /app/publish .
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 164.7 MiB
--> 104a2947532b
[2/2] STEP 7/12: ENV ASPNETCORE_URLS=http://+:5000
--> 25f0976a4b1e
[2/2] STEP 8/12: ENV ASPNETCORE_ENVIRONMENT=Production
--> 6bbdc03c467a
[2/2] STEP 9/12: ENV ConnectionStrings__DefaultConnection="Data Source=/app/data/myblog.db"
--> 92f0716b1262
[2/2] STEP 10/12: USER appuser
--> eda748256b14
[2/2] STEP 11/12: EXPOSE 5000
--> cc0fcdc62f57
[2/2] STEP 12/12: ENTRYPOINT ["dotnet", "MyBlog.Web.dll"]
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 164.7 MiB
[2/2] COMMIT myblog_myblog-web
--> df96b14a93c2
Successfully tagged localhost/myblog_myblog-web:latest
df96b14a93c251981a2bb3ed1f8d0c74407ce902944300ca923e0e96199b3e21
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 164.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 164.7 MiB
Chromium 143.0.7499.4 (playwright build v1200) downloaded to /root/.cache/ms-playwright/chromium-1200
Downloading FFMPEG playwright build v1011 from https://cdn.playwright.dev/dbazure/download/playwright/builds/ffmpeg/1011/ffmpeg-linux.zip
(node:45) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 2.3 MiB
|■■■■■■■■                                                                        |  10% of 2.3 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 2.3 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 2.3 MiB
FFMPEG playwright build v1011 downloaded to /root/.cache/ms-playwright/ffmpeg-1011
Downloading Chromium Headless Shell 143.0.7499.4 (playwright build v1200) from https://cdn.playwright.dev/dbazure/download/playwright/builds/chromium/1200/chromium-headless-shell-linux.zip
(node:56) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
|                                                                                |   0% of 109.7 MiB
|■■■■■■■■                                                                        |  10% of 109.7 MiB
|■■■■■■■■■■■■■■■■                                                                |  20% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■                                                        |  30% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                                |  40% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                        |  50% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                                |  60% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                        |  70% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■                |  80% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■        |  90% of 109.7 MiB
|■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■| 100% of 109.7 MiB
Chromium Headless Shell 143.0.7499.4 (playwright build v1200) downloaded to /root/.cache/ms-playwright/chromium_headless_shell-1200
--> f2e96efca3d1
STEP 15/18: WORKDIR /src/MyBlog.E2E
--> d7bbf4c08a5d
STEP 16/18: ENV MYBLOG_BASE_URL=http://myblog-web:5000
--> a3cd694bd94b
STEP 17/18: ENV PLAYWRIGHT_HEADLESS=true
--> 516ca0846198
STEP 18/18: ENTRYPOINT ["dotnet", "run", "-c", "Release", "--no-build"]
COMMIT myblog_myblog-e2e
--> d4cb540ec686
Successfully tagged localhost/myblog_myblog-e2e:latest
d4cb540ec686ce0a91cf5218db2e3ff6b1a6e0f85266ad4299ea1c4cb22b0d7e
[INFO] Starting MyBlog web service...
90b53e95b7f10884484dc879a4e048b33f42b52967fe99b8a50655bde89dc800
35ea39560cc3654fc9896afe4c4677afbaec7254b91d57f02af5ad47daaf45d0
myblog-web
[INFO] Waiting for MyBlog to be ready...
.
[INFO] MyBlog is ready!
[INFO] Running E2E tests...
7be5a33daa8d418fdecc6216b27bf7f4dc657610b57ac47c48d3e613279f3ed0
[myblog-web] | cannot open `/run/user/1000/crun/35ea39560cc3654fc9896afe4c4677afbaec7254b91d57f02af5ad47daaf45d0/exec.fifo`: No such file or directory
[myblog-web] | Error: unable to start container 35ea39560cc3654fc9896afe4c4677afbaec7254b91d57f02af5ad47daaf45d0: `/usr/bin/crun start 35ea39560cc3654fc9896afe4c4677afbaec7254b91d57f02af5ad47daaf45d0` failed: exit status 1
[myblog-e2e] | xUnit.net v3 In-Process Runner v3.2.2+728c1dce01 (64-bit .NET 10.0.1)
[myblog-e2e] |   Discovering: MyBlog.E2E
[myblog-e2e] |   Discovered:  MyBlog.E2E
[myblog-e2e] |   Starting:    MyBlog.E2E
[myblog-e2e] |   Finished:    MyBlog.E2E (ID = '4d488734a9156ea8719a93bca3e9cb47dfeac4715a7981582060bf185a1e7bf4')
[myblog-e2e] | === TEST EXECUTION SUMMARY ===
[myblog-e2e] |    MyBlog.E2E  Total: 15, Errors: 0, Failed: 0, Skipped: 0, Not Run: 0, Time: 5.752s
[myblog-e2e] | 
[INFO] Capturing logs...
[INFO] Cleaning up...
myblog-e2e
myblog-web
myblog-e2e
myblog-web
myblog_myblog-data
90b53e95b7f10884484dc879a4e048b33f42b52967fe99b8a50655bde89dc800
myblog_myblog-network
[INFO] E2E tests passed! ✓

real	0m45.485s
user	0m29.281s
sys	0m16.284s
kushal@fedora:~/src/dotnet/MyBlog$ 
