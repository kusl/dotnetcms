@page "/post/{Slug}"
@inject IPostRepository PostRepository

@if (_post is not null)
{
    <article class="post-detail">
        <header class="post-header">
            <h1>@_post.Title</h1>
            <div class="post-meta">
                <span>By @_post.AuthorDisplayName</span>

                @* This tiny component handles the 'Phone Call' (SignalR) *@
                <ReaderBadge Slug="@Slug" />
            </div>
        </header>

        <div class="post-content">
            <MarkdownRenderer Content="@_post.Content" />
        </div>
    </article>
}

@code {
    [Parameter] public string Slug { get; set; } = "";
    private PostDetailDto? _post;

    protected override async Task OnParametersSetAsync()
    {
        _post = await PostRepository.GetBySlugAsync(Slug);
    }
}
