@inherits LayoutComponentBase
@inject IConfiguration Configuration
@inject NavigationManager Navigation

<div class="layout">
    <header class="header">
        <div class="container">
            <a href="/" class="logo">@(Configuration["Application:Title"] ?? "MyBlog")</a>
            <nav class="nav">
                <a href="/">Home</a>
                <a href="/about">About</a>
                <AuthorizeView>
                    <Authorized>
                        <a href="/admin">Dashboard</a>
                        <a href="/admin/users">Users</a>
                        <form method="post" action="/logout" class="logout-form">
                            <AntiforgeryToken />
                            <button type="submit">Logout</button>
                        </form>
                    </Authorized>
                    <NotAuthorized>
                        <a href="/login">Login</a>
                    </NotAuthorized>
                </AuthorizeView>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            @Body
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; @DateTime.Now.Year @(Configuration["Application:Title"] ?? "MyBlog")</p>

            @{
                var gitUrl = Configuration["Application:GitForgeUrl"];
                // Checks if it's not empty AND is a valid absolute URL (http/https)
                if (!string.IsNullOrWhiteSpace(gitUrl) &&
                    Uri.TryCreate(gitUrl, UriKind.Absolute, out var validatedUri) &&
                    (validatedUri.Scheme == Uri.UriSchemeHttp || validatedUri.Scheme == Uri.UriSchemeHttps))
                {
                    <p>
                        Read the source code at
                        <a href="@gitUrl" target="_blank" rel="noopener noreferrer">@gitUrl</a>
                    </p>
                }
            }
        </div>
    </footer>
</div>
